initJQueryPayments=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u=[].slice,v=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};b=a,b.payment={},b.payment.fn={},b.fn.payment=function(){var a,c;return c=arguments[0],a=2<=arguments.length?u.call(arguments,1):[],b.payment.fn[c].apply(this,a)},f=/(\d{1,4})/g,e=[{type:"maestro",pattern:/^(5018|5020|5038|6304|6759|676[1-3])/,format:f,length:[12,13,14,15,16,17,18,19],cvcLength:[3],luhn:!0},{type:"dinersclub",pattern:/^(36|38|30[0-5])/,format:f,length:[14],cvcLength:[3],luhn:!0},{type:"laser",pattern:/^(6706|6771|6709)/,format:f,length:[16,17,18,19],cvcLength:[3],luhn:!0},{type:"jcb",pattern:/^35/,format:f,length:[16],cvcLength:[3],luhn:!0},{type:"unionpay",pattern:/^62/,format:f,length:[16,17,18,19],cvcLength:[3],luhn:!1},{type:"discover",pattern:/^(6011|65|64[4-9]|622)/,format:f,length:[16],cvcLength:[3],luhn:!0},{type:"mastercard",pattern:/^5[1-5]/,format:f,length:[16],cvcLength:[3],luhn:!0},{type:"amex",pattern:/^3[47]/,format:/(\d{1,4})(\d{1,6})?(\d{1,5})?/,length:[15],cvcLength:[3,4],luhn:!0},{type:"visa",pattern:/^4/,format:f,length:[13,14,15,16],cvcLength:[3],luhn:!0}],c=function(a){var b,c,d;for(a=(a+"").replace(/\D/g,""),c=0,d=e.length;d>c;c++)if(b=e[c],b.pattern.test(a))return b},d=function(a){var b,c,d;for(c=0,d=e.length;d>c;c++)if(b=e[c],b.type===a)return b},n=function(a){var b,c,d,e,f,g;for(d=!0,e=0,c=(a+"").split("").reverse(),f=0,g=c.length;g>f;f++)b=c[f],b=parseInt(b,10),(d=!d)&&(b*=2),b>9&&(b-=9),e+=b;return e%10===0},m=function(a){var b;return null!=a.prop("selectionStart")&&a.prop("selectionStart")!==a.prop("selectionEnd")?!0:("undefined"!=typeof document&&null!==document?null!=(b=document.selection)?"function"==typeof b.createRange?b.createRange().text:void 0:void 0:void 0)?!0:!1},o=function(a){return setTimeout(function(){var c,d;return c=b(a.currentTarget),d=c.val(),d=b.payment.formatCardNumber(d),c.val(d)})},i=function(a){var d,e,f,g,h,i,j;return f=String.fromCharCode(a.which),!/^\d+$/.test(f)||(d=b(a.currentTarget),j=d.val(),e=c(j+f),g=(j.replace(/\D/g,"")+f).length,i=16,e&&(i=e.length[e.length.length-1]),g>=i||null!=d.prop("selectionStart")&&d.prop("selectionStart")!==j.length)?void 0:(h=e&&"amex"===e.type?/^(\d{4}|\d{4}\s\d{6})$/:/(?:^|\s)(\d{4})$/,h.test(j)?(a.preventDefault(),d.val(j+" "+f)):h.test(j+f)?(a.preventDefault(),d.val(j+f+" ")):void 0)},g=function(a){var c,d;return c=b(a.currentTarget),d=c.val(),a.meta||8!==a.which||null!=c.prop("selectionStart")&&c.prop("selectionStart")!==d.length?void 0:/\d\s$/.test(d)?(a.preventDefault(),c.val(d.replace(/\d\s$/,""))):/\s\d?$/.test(d)?(a.preventDefault(),c.val(d.replace(/\s\d?$/,""))):void 0},j=function(a){var c,d,e;return d=String.fromCharCode(a.which),/^\d+$/.test(d)?(c=b(a.currentTarget),e=c.val()+d,/^\d$/.test(e)&&"0"!==e&&"1"!==e?(a.preventDefault(),c.val("0"+e+" / ")):/^\d\d$/.test(e)?(a.preventDefault(),c.val(""+e+" / ")):void 0):void 0},k=function(a){var c,d,e;return d=String.fromCharCode(a.which),/^\d+$/.test(d)?(c=b(a.currentTarget),e=c.val(),/^\d\d$/.test(e)?c.val(""+e+" / "):void 0):void 0},l=function(a){var c,d,e;return d=String.fromCharCode(a.which),"/"===d?(c=b(a.currentTarget),e=c.val(),/^\d$/.test(e)&&"0"!==e?c.val("0"+e+" / "):void 0):void 0},h=function(a){var c,d;if(!a.meta&&(c=b(a.currentTarget),d=c.val(),8===a.which&&(null==c.prop("selectionStart")||c.prop("selectionStart")===d.length)))return/\d(\s|\/)+$/.test(d)?(a.preventDefault(),c.val(d.replace(/\d(\s|\/)*$/,""))):/\s\/\s?\d?$/.test(d)?(a.preventDefault(),c.val(d.replace(/\s\/\s?\d?$/,""))):void 0},s=function(a){var b;return a.metaKey||a.ctrlKey?!0:32===a.which?!1:0===a.which?!0:a.which<33?!0:(b=String.fromCharCode(a.which),!!/[\d\s]/.test(b))},q=function(a){var d,e,f,g;return d=b(a.currentTarget),f=String.fromCharCode(a.which),/^\d+$/.test(f)&&!m(d)?(g=(d.val()+f).replace(/\D/g,""),e=c(g),e?g.length<=e.length[e.length.length-1]:g.length<=16):void 0},r=function(a){var c,d,e;return c=b(a.currentTarget),d=String.fromCharCode(a.which),/^\d+$/.test(d)&&!m(c)?(e=c.val()+d,e=e.replace(/\D/g,""),e.length>6?!1:void 0):void 0},p=function(a){var c,d,e;return c=b(a.currentTarget),d=String.fromCharCode(a.which),/^\d+$/.test(d)?(e=c.val()+d,e.length<=4):void 0},t=function(a){var c,d,f,g,h;return c=b(a.currentTarget),h=c.val(),g=b.payment.cardType(h)||"unknown",c.hasClass(g)?void 0:(d=function(){var a,b,c;for(c=[],a=0,b=e.length;b>a;a++)f=e[a],c.push(f.type);return c}(),c.removeClass("unknown"),c.removeClass(d.join(" ")),c.addClass(g),c.toggleClass("identified","unknown"!==g),c.trigger("payment.cardType",g))},b.payment.fn.formatCardCVC=function(){return this.payment("restrictNumeric"),this.on("keypress",p),this},b.payment.fn.formatCardExpiry=function(){return this.payment("restrictNumeric"),this.on("keypress",r),this.on("keypress",j),this.on("keypress",l),this.on("keypress",k),this.on("keydown",h),this},b.payment.fn.formatCardNumber=function(){return this.payment("restrictNumeric"),this.on("keypress",q),this.on("keypress",i),this.on("keydown",g),this.on("keyup",t),this.on("paste",o),this},b.payment.fn.restrictNumeric=function(){return this.on("keypress",s),this},b.payment.fn.cardExpiryVal=function(){return b.payment.cardExpiryVal(b(this).val())},b.payment.cardExpiryVal=function(a){var b,c,d,e;return a=a.replace(/\s/g,""),e=a.split("/",2),b=e[0],d=e[1],2===(null!=d?d.length:void 0)&&/^\d+$/.test(d)&&(c=(new Date).getFullYear(),c=c.toString().slice(0,2),d=c+d),b=parseInt(b,10),d=parseInt(d,10),{month:b,year:d}},b.payment.validateCardNumber=function(a){var b,d;return a=(a+"").replace(/\s+|-/g,""),/^\d+$/.test(a)?(b=c(a),b?(d=a.length,v.call(b.length,d)>=0&&(b.luhn===!1||n(a))):!1):!1},b.payment.validateCardExpiry=function(a,c){var d,e,f,g;return"object"==typeof a&&"month"in a&&(g=a,a=g.month,c=g.year),a&&c?(a=b.trim(a),c=b.trim(c),/^\d+$/.test(a)?/^\d+$/.test(c)?parseInt(a,10)<=12?(2===c.length&&(f=(new Date).getFullYear(),f=f.toString().slice(0,2),c=f+c),e=new Date(c,a),d=new Date,e.setMonth(e.getMonth()-1),e.setMonth(e.getMonth()+1,1),e>d):!1:!1:!1):!1},b.payment.validateCardCVC=function(a,c){var e,f;return a=b.trim(a),/^\d+$/.test(a)?c?(e=a.length,v.call(null!=(f=d(c))?f.cvcLength:void 0,e)>=0):a.length>=3&&a.length<=4:!1},b.payment.cardType=function(a){var b;return a?(null!=(b=c(a))?b.type:void 0)||null:null},b.payment.formatCardNumber=function(a){var b,d,e,f;return(b=c(a))?(e=b.length[b.length.length-1],a=a.replace(/\D/g,""),a=a.slice(0,+e+1||9e9),b.format.global?null!=(f=a.match(b.format))?f.join(" "):void 0:(d=b.format.exec(a),null!=d&&d.shift(),null!=d?d.join(" "):void 0)):a}},function(a,b){"function"==typeof define&&define.amd?define(b):a.form2js=b()}(this,function(){"use strict";function a(a,d,e,f,g){("undefined"==typeof e||null==e)&&(e=!0),("undefined"==typeof d||null==d)&&(d="."),arguments.length<5&&(g=!1),a="string"==typeof a?document.getElementById(a):a;var h,i=[],j=0;if(a.constructor==Array||"undefined"!=typeof NodeList&&a.constructor==NodeList)for(;h=a[j++];)i=i.concat(c(h,f,g));else i=c(a,f,g);return b(i,e,d)}function b(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q={},r={};for(d=0;d<a.length;d++)if(h=a[d].value,!b||""!==h&&null!==h){for(o=a[d].name,p=o.split(c),i=[],j=q,k="",e=0;e<p.length;e++)if(n=p[e].split("]["),n.length>1)for(f=0;f<n.length;f++)if(n[f]=0==f?n[f]+"]":f==n.length-1?"["+n[f]:"["+n[f]+"]",m=n[f].match(/([a-z_]+)?\[([a-z_][a-z0-9_]+?)\]/i))for(g=1;g<m.length;g++)m[g]&&i.push(m[g]);else i.push(n[f]);else i=i.concat(n);for(e=0;e<i.length;e++)n=i[e],n.indexOf("[]")>-1&&e==i.length-1?(l=n.substr(0,n.indexOf("[")),k+=l,j[l]||(j[l]=[]),j[l].push(h)):n.indexOf("[")>-1?(l=n.substr(0,n.indexOf("[")),m=n.replace(/(^([a-z_]+)?\[)|(\]$)/gi,""),k+="_"+l+"_"+m,r[k]||(r[k]={}),""==l||j[l]||(j[l]=[]),e==i.length-1?""==l?(j.push(h),r[k][m]=j[j.length-1]):(j[l].push(h),r[k][m]=j[l][j[l].length-1]):r[k][m]||(j[l].push(/^[0-9a-z_]+\[?/i.test(i[e+1])?{}:[]),r[k][m]=j[l][j[l].length-1]),j=r[k][m]):(k+=n,e<i.length-1?(j[n]||(j[n]={}),j=j[n]):j[n]=h)}return q}function c(a,b,c){var f=e(a,b,c);return f.length>0?f:d(a,b,c)}function d(a,b,c){for(var d=[],f=a.firstChild;f;)d=d.concat(e(f,b,c)),f=f.nextSibling;return d}function e(a,b,c){var e,h,i,j=f(a,c);return e=b&&b(a),e&&e.name?i=[e]:""!=j&&a.nodeName.match(/INPUT|TEXTAREA/i)?(h=g(a),i=[{name:j,value:h}]):""!=j&&a.nodeName.match(/SELECT/i)?(h=g(a),i=[{name:j.replace(/\[\]$/,""),value:h}]):i=d(a,b,c),i}function f(a,b){return a.name&&""!=a.name?a.name:b&&a.id&&""!=a.id?a.id:""}function g(a){if(a.disabled)return null;switch(a.nodeName){case"INPUT":case"TEXTAREA":switch(a.type.toLowerCase()){case"radio":if(a.checked&&"false"===a.value)return!1;case"checkbox":if(a.checked&&"true"===a.value)return!0;if(!a.checked&&"true"===a.value)return!1;if(a.checked)return a.value;break;case"button":case"reset":case"submit":case"image":return"";default:return a.value}break;case"SELECT":return h(a)}return null}function h(a){var b,c,d,e=a.multiple,f=[];if(!e)return a.value;for(b=a.getElementsByTagName("option"),c=0,d=b.length;d>c;c++)b[c].selected&&f.push(b[c].value);return f}return a});var donationsForm={},$,__indexOf=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};donationsForm.init=function(a,b){$=a;var c,d,e,f,g,h,i,j,k;c=$.extend({},{imgpath:"https://d3dy5gmtp8yhk7.cloudfront.net",metaviewporttag:!0},donationsForm.parseQueryString(document.URL.split("?")[1]),b),g='<meta name="viewport" content="width=device-width, initial-scale=1">',c.metaviewporttag===!1&&(g=""),$(".donations-form-anchor").append(function(){return'<div class="cleanslate donations-callback-flash">\n  Success! You\'ll receive a notification for your payment. \n</div>\n\n'+g+'\n<form class="cleanslate donation-form" id="donation-form" autocomplete="on">\n  <div class="donation-loading-overlay"></div>\n  <input type="hidden" name="organization_slug" value="'+c.org+'">\n  <input type="hidden" name="customer.charges_attributes[0].currency" value="usd">\n  <div class="donation-header">\n    <div class="donation-header-main-message">\n      I\'M DONATING\n    </div>\n    <div class="donation-subheader-amount">\n      <span class=\'donation-currency\'>$</span>0\n    </div>\n  </div>\n  <div class="donation-progress-banner">\n    <div class="donation-progress-banner-container">\n      <span class="donation-progress-header dph-active" id="dnt-progress-amount">\n        Amount\n      </span>\n      <span class="donation-progress-arrow"></span>\n      <span class="donation-progress-header" id="dnt-progress-myinfo">\n        My Info\n      </span>\n      <span class="donation-progress-arrow"></span>\n      <span class="donation-progress-header" id="dnt-progress-payment">\n        Payment\n      </span>\n    </div>\n  </div>\n  <div class="donation-input-set" id="input-set-first">\n    <span class="donation-field-label">\n      <span class="donation-error-label" id="d-error-label-first">You must choose an amount.</span>\n    </span>\n    <div class="donation-input-row">\n      <div class="donation-btn donation-btn-sm '+("1"===c.select?"donation-btn-active":void 0)+"\" ><span class='donation-currency'>$</span>"+(c.amt1||15)+'</div>\n      <div class="donation-btn donation-btn-sm '+("2"===c.select?"donation-btn-active":void 0)+"\"><span class='donation-currency'>$</span>"+(c.amt2||35)+'</div>\n      <div class="donation-btn donation-btn-sm '+("3"===c.select?"donation-btn-active":void 0)+"\"><span class='donation-currency'>$</span>"+(c.amt3||50)+'</div>\n    </div>\n    <div class="donation-input-row">      \n      <div class="donation-btn donation-btn-sm '+("4"===c.select?"donation-btn-active":void 0)+"\"><span class='donation-currency'>$</span>"+(c.amt4||100)+'</div>\n      <div class="donation-btn donation-btn-sm '+("5"===c.select?"donation-btn-active":void 0)+"\"><span class='donation-currency'>$</span>"+(c.amt5||250)+'</div>\n      <div class="donation-btn donation-btn-sm '+("6"===c.select?"donation-btn-active":void 0)+"\"><span class='donation-currency'>$</span>"+(c.amt6||500)+'</div>\n    </div>\n    <div class="donation-input-row"> \n      <div class="donation-btn donation-btn-sm '+("7"===c.select?"donation-btn-active":void 0)+"\"><span class='donation-currency'>$</span>"+(c.amt7||1e3)+'</div>\n      <input class="donation-btn donation-btn-lg" type="text" placeholder="Other amount">\n    </div>\n    <div class="donation-next-btn" id="donation-first-next-btn">\n      <div class="donation-next-btn-header">\n        NEXT\n      </div>\n    </div>\n  </div>\n  \n  <div class="donation-input-set">\n    <div class="donation-input-row">\n      <span class="donation-field-label">\n        First Name*\n        <span class="donation-error-label">Can\'t be blank</span>\n      </span>\n      \n      <input type="text" class="donation-text-field" autocompletetype="given-name" name="customer.first_name">\n    </div>\n    <div class="donation-input-row">      \n      <span class="donation-field-label">\n        Last Name*\n        <span class="donation-error-label">Can\'t be blank</span>\n      </span>\n      \n      <input type="text" class="donation-text-field" autocompletetype="family-name" name="customer.last_name">\n    </div>\n    <div class="donation-input-row"> \n      <span class="donation-field-label">\n        Email*\n        <span class="donation-error-label">Invalid email format</span>\n      </span>\n      \n      <input type="email" class="donation-text-field" autocompletetype="email" name="customer.email">\n    </div>\n    <div class="donation-next-btn" id="donation-second-next-btn">\n      <div class="donation-next-btn-header">\n        NEXT\n      </div>\n    </div>\n  </div>\n  \n  <div class="donation-input-set">\n    <div class="donation-input-row">\n      <span class="donation-field-label">\n        Card Number*\n        <span class="donation-error-label">Invalid number</span>\n      </span>\n      <input name="cc-num" type="cc-num" class="donation-text-field" autocompletetype="cc-number" data-stripe="number">\n    </div>\n    <div class="donation-input-row"> \n      <span class="donation-field-label">\n        Expiration*\n        <span class="donation-error-label">Invalid date</span>\n      </span>\n      <select name="month" class="donation-select" type="month" data-stripe="exp-month">\n      </select>\n      <select name="year" class="donation-select" type="year" data-stripe="exp-year">\n      </select>\n    </div>\n    <div class="donation-input-row"> \n      <span class="donation-field-label">\n        CVV/CVC* <a class="what-is-cvv" title="For MasterCard, Visa or Discover, it\'s the three digits in the signature area on the back of your card. For American Express, it\'s the four digits on the front of the card.">What is this?</a>\n        <span class="donation-error-label">Invalid CVV number</span>\n      </span>\n      <input name="cvc" type="cvc" class="donation-text-field donation-text-field-sm" autocomplete="off" data-stripe="cvc">\n    </div>\n    <div class="donation-payment-errors">\n      Something went wrong.\n    </div>\n    <button type="submit" class="donation-submit">\n      <div class="donation-submit-header">\n        SUBMIT\n      </div>\n    </div>\n  </div>\n</form>'}),$.ajax({type:"get",url:"https://freegeoip.net/json/",dataType:"jsonp",success:function(a){var b,c;return b=donationsForm.getCurrencyFromCountryCode(a.country_code),c=donationsForm.getSymbolFromCurrency(b),$("input[name='customer.charges_attributes[0].currency']").val(b),$(".donation-currency").html(c)}}),$("#donation-form").show(),d=this,e={"#dnt-progress-amount":"icon-amount.png","#dnt-progress-myinfo":"icon-myinfo.png","#dnt-progress-payment":"icon-payment.png",".donation-progress-arrow":"icon-arrow.png",'.donation-text-field[type="cc-num"]':"icon-cc-none.png",".donation-select":"icon-dropdown-arrows.png",".donation-loading-overlay":"712.GIF"};for(f in e)j=e[f],$(f).css("background-image","url('"+c.imgpath+"/"+j+"')");return k=function(a){var b,c,d,e,f,g;if(c=!0,0===$(".donation-input-set").index(a)&&0===a.find(".donation-btn-active").length)return gaDonations("send","event","error","initiated","amount",1),$(".donation-error-label").first().show(),!1;for($(".donation-error-label").first().hide(),g=a.find(".donation-text-field, .donation-select"),e=0,f=g.length;f>e;e++)b=g[e],d=donationsForm.validField($(b).val(),$(b).attr("type")),d!==!0?(gaDonations("send","event","error","initiated",$(b).attr("name"),1),c=!1,$(b).addClass("donation-text-field-error"),$(b).parent().find(".donation-error-label").text(d),$(b).parent().find(".donation-error-label").show()):($(b).removeClass("donation-text-field-error"),$(b).parent().find(".donation-error-label").hide());return c},$(".donation-next-btn").click(function(){var a,b;return k($(this).parent())?(gaDonations("send","event","advance-button","click#success",$(this).attr("id"),1),a=$(this).parent(),b=$(this).parent().next(),$(".donation-progress-header").eq($(".donation-input-set").index(b)).addClass("dph-active"),b.show(),a.hide()):gaDonations("send","event","advance-button","click#with-errors",$(this).attr("id"),1)}),$(".donation-submit").click(function(){return k($(this).parent())}),$(".donation-text-field").blur(function(){var a,b;return a=$(this),b=donationsForm.validField(a.val(),a.attr("type")),b===!0?(a.removeClass("donation-text-field-error"),a.parent().find(".donation-error-label").hide(),a.addClass("donation-text-field-completed")):(a.addClass("donation-text-field-error"),a.parent().find(".donation-error-label").text(b),a.parent().find(".donation-error-label").show(),void 0)}),$(".donation-text-field[type=cc-num]").blur(function(){var a,b;return a=$(this),b=$.payment.cardType(a.val()),"amex"===b||"mastercard"===b||"visa"===b||"discover"===b||"dinersclub"===b?a.css("background-image","url("+c.imgpath+"/icon-cc-"+b+".png)"):void 0}),$(".donation-select[type='month']").html(function(){var a,b,c;for(b=["<option value='' disabled selected>Month</option>"],a=1;12>=a;)c=a>9?""+a:"0"+a,b.push("<option value='"+c+"'>"+c+"</option>"),a++;return b.join("")}),$(".donation-select[type='year']").html(function(){var a,b,c,d,e;for(b=(new Date).getFullYear(),a=["<option value='' disabled selected>Year</option>"],c=d=b,e=b+19;e>=b?e>=d:d>=e;c=e>=b?++d:--d)a.push("<option value='"+c+"'>"+c+"</option>");return a}),h=function(a){return $(".donation-subheader-amount").text(""+a)},$(".donation-btn-sm").click(function(){return gaDonations("send","event","amount","click",$(this).text(),1),h($(this).text()),$(".donation-btn-active").removeClass("donation-btn-active"),$(this).addClass("donation-btn-active")}),$(".donation-btn-lg").change(function(){return $(this).val()?(gaDonations("send","event","amount","click",$(this).val(),1),$(".donation-btn-active").removeClass("donation-btn-active"),$(this).addClass("donation-btn-active"),h("$"+$(this).val())):void 0}),i=function(a){var b,c;for(b=1;a>=b;)$(".donation-progress-header").eq(b).addClass("dph-active"),b++;for(c=[];2>=b;)$(".donation-progress-header").eq(b).removeClass("dph-active"),c.push(b++);return c},$(".donation-progress-header").click(function(){var a,b,c;return a=$(".donation-progress-header").index($(this)),c=$(".donation-input-set").eq(a),b=$(".donation-input-set").filter(":visible:first"),k(b)?(gaDonations("send","event","advance-button","click#with-errors",$(this).attr("id"),1),i(a),c.show(),b.hide()):gaDonations("send","event","advance-button","click#with-errors",$(this).attr("id"),1)}),$('.donation-text-field[type="cc-num"]').payment("formatCardNumber"),$('.donation-text-field[type="cvc"]').payment("formatCardCVC"),$(".donation-btn-lg").payment("restrictNumeric"),donationsForm.connectToServer(c),this},donationsForm.parseQueryString=function(a){var b,c,d;if(b={},void 0!==a&&""!==a)for(a=a.split("&"),c=0;c<a.length;)d=a[c].split("="),b[d[0]]=d[1],c++;return b},donationsForm.getCurrencyFromCountryCode=function(a){var b,c,d;return d=["AT","BE","BG","HR","CY","CZ","DK","EE","FI","FR","DE","GR","HU","IE","IT","LV","LT","LU","MT","NL","PL","PT","RO","SK","SI","ES","SE"],b={US:"USD",GB:"GBP",AU:"AUD",CA:"CAN"},c=b[a],null!=c?c:__indexOf.call(d,a)>=0?"EUR":"USD"},donationsForm.getSymbolFromCurrency=function(a){var b;return b={USD:"$",GBP:"&pound;",EUR:"&euro;"},b[a]||"$"},donationsForm.validField=function(a,b){var c,d,e;return a?"email"===b?(d=/[a-z0-9!#$%&'*+/=?^_{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/,d.test(a)?!0:"Invalid email format."):"cc-num"===b?$.payment.validateCardNumber(a)?!0:"Invalid card format.":"cvc"===b?$.payment.validateCardCVC(a)?!0:"Invalid CVC.":"month"===b||"year"===b?("month"===b&&(e=$(".donation-select[type='year']").val(),c=a),"year"===b&&(c=$(".donation-select[type='month']").val(),e=a),/^\d+$/.test(c)&&/^\d+$/.test(e)?$.payment.validateCardExpiry(c,e)?!0:"Expiry must be in the future.":"Invalid expiry date."):!0:"Can't be blank"},donationsForm.hide=function(){return $("#donation-form").hide()},donationsForm.connectToServer=function(a){var b,c,d;return b=$.extend({},{stripepublickey:"pk_test_LGrYxpfzI89s9yxXJfKcBB0R",pusherpublickey:"331ca3447b91e264a76f",pathtoserver:"http://localhost:3000"},a),Stripe.setPublishableKey(b.stripepublickey),$.fn.serializeObject=function(){var a,b;return b=form2js(this.attr("id"),".",!0),a=$(".donation-btn-active").text()?$(".donation-btn-active").text():$(".donation-btn-active").val(),b.customer.charges_attributes[0].amount=a.replace("$","")+"00",b},d=function(a){var c,d;return d=new Pusher(b.pusherpublickey),c=d.subscribe(a),c.bind("charge_completed",function(a){return $(".donation-loading-overlay").hide(),d.disconnect(),"success"===a.status?(donationsForm.hide(),$(".donations-callback-flash").show(0).delay(8e3).hide(0)):$(".donation-payment-errors").text(a.message||"Something went wrong.").show()})},c=function(a,c){var e,f,g;return e=$("#donation-form"),c.error?(gaDonations("send","event","advance-button","click#with-errors","submit",1),e.find(".donation-payment-errors").text(c.error.message),e.find("button").prop("disabled",!1),$(".donation-loading-overlay").hide()):(g=c.id,e.append($('<input type="hidden" name="card_token" />').val(g)),f=$.ajax({url:""+b.pathtoserver+"/charges",type:"post",data:$("#donation-form").serializeObject()}),f.done(function(a){return gaDonations("send","event","advance-button","click#success","submit",1),d(a.pusher_channel_token)}),f.fail(function(a,b,c){return gaDonations("send","event","advance-button","click#with-errors","submit",1),e.find(".donation-payment-errors").text(c||"Something went wrong.").show(),$(".donation-loading-overlay").hide()}),!1)},$("#donation-form").submit(function(){var a;return gaDonations("send","event","advance-button","click#submit","submit",1),a=$(this),$(".donation-loading-overlay").show(),a.find("button").prop("disabled",!0),Stripe.createToken(a,c),!1})};