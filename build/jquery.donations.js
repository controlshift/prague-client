(function(){function e(t,n){(null===t||void 0===t)&&e.warn("Warning","You must pass your app key when you instantiate Pusher.");var n=n||{},r=this;this.key=t,this.config=e.Util.extend(e.getGlobalConfig(),n.cluster?e.getClusterConfig(n.cluster):{},n),this.channels=new e.Channels,this.global_emitter=new e.EventsDispatcher,this.sessionID=Math.floor(1e9*Math.random()),this.timeline=new e.Timeline(this.key,this.sessionID,{features:e.Util.getClientFeatures(),params:this.config.timelineParams||{},limit:50,level:e.Timeline.INFO,version:e.VERSION}),this.config.disableStats||(this.timelineSender=new e.TimelineSender(this.timeline,{host:this.config.statsHost,path:"/timeline"})),this.connection=new e.ConnectionManager(this.key,e.Util.extend({getStrategy:function(t){return e.StrategyBuilder.build(e.getDefaultStrategy(r.config),e.Util.extend({},r.config,t))},timeline:this.timeline,activityTimeout:this.config.activity_timeout,pongTimeout:this.config.pong_timeout,unavailableTimeout:this.config.unavailable_timeout},this.config,{encrypted:this.isEncrypted()})),this.connection.bind("connected",function(){r.subscribeAll(),r.timelineSender&&r.timelineSender.send(r.connection.isEncrypted())}),this.connection.bind("message",function(e){var t=0===e.event.indexOf("pusher_internal:");if(e.channel){var n=r.channel(e.channel);n&&n.handleEvent(e.event,e.data)}t||r.global_emitter.emit(e.event,e.data)}),this.connection.bind("disconnected",function(){r.channels.disconnect()}),this.connection.bind("error",function(t){e.warn("Error",t)}),e.instances.push(this),this.timeline.info({instances:e.instances.length}),e.isReady&&r.connect()}var t=e.prototype;e.instances=[],e.isReady=!1,e.debug=function(){e.log&&e.log(e.Util.stringify.apply(this,arguments))},e.warn=function(){var t=e.Util.stringify.apply(this,arguments);window.console&&(window.console.warn?window.console.warn(t):window.console.log&&window.console.log(t)),e.log&&e.log(t)},e.ready=function(){e.isReady=!0;for(var t=0,n=e.instances.length;n>t;t++)e.instances[t].connect()},t.channel=function(e){return this.channels.find(e)},t.allChannels=function(){return this.channels.all()},t.connect=function(){if(this.connection.connect(),this.timelineSender&&!this.timelineSenderTimer){var t=this.connection.isEncrypted(),n=this.timelineSender;this.timelineSenderTimer=new e.PeriodicTimer(6e4,function(){n.send(t)})}},t.disconnect=function(){this.connection.disconnect(),this.timelineSenderTimer&&(this.timelineSenderTimer.ensureAborted(),this.timelineSenderTimer=null)},t.bind=function(e,t){return this.global_emitter.bind(e,t),this},t.bind_all=function(e){return this.global_emitter.bind_all(e),this},t.subscribeAll=function(){for(var e in this.channels.channels)this.channels.channels.hasOwnProperty(e)&&this.subscribe(e)},t.subscribe=function(e){return e=this.channels.add(e,this),"connected"===this.connection.state&&e.subscribe(),e},t.unsubscribe=function(e){e=this.channels.remove(e),"connected"===this.connection.state&&e.unsubscribe()},t.send_event=function(e,t,n){return this.connection.send_event(e,t,n)},t.isEncrypted=function(){return"https:"===e.Util.getDocumentLocation().protocol?!0:Boolean(this.config.encrypted)},this.Pusher=e}).call(this),function(){function e(e,t){var n=this;this.timeout=setTimeout(function(){null!==n.timeout&&(t(),n.timeout=null)},e)}var t=e.prototype;t.isRunning=function(){return null!==this.timeout},t.ensureAborted=function(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null)},Pusher.Timer=e}.call(this),function(){function e(e,t){var n=this;this.interval=setInterval(function(){null!==n.interval&&t()},e)}var t=e.prototype;t.isRunning=function(){return null!==this.interval},t.ensureAborted=function(){this.interval&&(clearInterval(this.interval),this.interval=null)},Pusher.PeriodicTimer=e}.call(this),function(){Pusher.Util={now:function(){return Date.now?Date.now():(new Date).valueOf()},defer:function(e){return new Pusher.Timer(0,e)},extend:function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)e[n]=r[n]&&r[n].constructor&&r[n].constructor===Object?Pusher.Util.extend(e[n]||{},r[n]):r[n]}return e},stringify:function(){for(var e=["Pusher"],t=0;t<arguments.length;t++)e.push("string"==typeof arguments[t]?arguments[t]:void 0===window.JSON?arguments[t].toString():JSON.stringify(arguments[t]));return e.join(" : ")},arrayIndexOf:function(e,t){var n=Array.prototype.indexOf;if(null===e)return-1;if(n&&e.indexOf===n)return e.indexOf(t);for(var n=0,r=e.length;r>n;n++)if(e[n]===t)return n;return-1},objectApply:function(e,t){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(e[n],n,e)},keys:function(e){var t=[];return Pusher.Util.objectApply(e,function(e,n){t.push(n)}),t},values:function(e){var t=[];return Pusher.Util.objectApply(e,function(e){t.push(e)}),t},apply:function(e,t){for(var n=0;n<e.length;n++)t(e[n],n,e)},map:function(e,t){for(var n=[],r=0;r<e.length;r++)n.push(t(e[r],r,e,n));return n},mapObject:function(e,t){var n={};return Pusher.Util.objectApply(e,function(e,r){n[r]=t(e)}),n},filter:function(e,t){for(var t=t||function(e){return!!e},n=[],r=0;r<e.length;r++)t(e[r],r,e,n)&&n.push(e[r]);return n},filterObject:function(e,t){var n={};return Pusher.Util.objectApply(e,function(r,i){(t&&t(r,i,e,n)||Boolean(r))&&(n[i]=r)}),n},flatten:function(e){var t=[];return Pusher.Util.objectApply(e,function(e,n){t.push([n,e])}),t},any:function(e,t){for(var n=0;n<e.length;n++)if(t(e[n],n,e))return!0;return!1},all:function(e,t){for(var n=0;n<e.length;n++)if(!t(e[n],n,e))return!1;return!0},method:function(e){var t=Array.prototype.slice.call(arguments,1);return function(n){return n[e].apply(n,t.concat(arguments))}},getDocument:function(){return document},getDocumentLocation:function(){return Pusher.Util.getDocument().location},getLocalStorage:function(){try{return window.localStorage}catch(e){}},getClientFeatures:function(){return Pusher.Util.keys(Pusher.Util.filterObject({ws:Pusher.WSTransport,flash:Pusher.FlashTransport},function(e){return e.isSupported()}))}}}.call(this),function(){Pusher.VERSION="2.1.6",Pusher.PROTOCOL=7,Pusher.host="ws.pusherapp.com",Pusher.ws_port=80,Pusher.wss_port=443,Pusher.sockjs_host="sockjs.pusher.com",Pusher.sockjs_http_port=80,Pusher.sockjs_https_port=443,Pusher.sockjs_path="/pusher",Pusher.stats_host="stats.pusher.com",Pusher.channel_auth_endpoint="/pusher/auth",Pusher.channel_auth_transport="ajax",Pusher.activity_timeout=12e4,Pusher.pong_timeout=3e4,Pusher.unavailable_timeout=1e4,Pusher.cdn_http="http://js.pusher.com/",Pusher.cdn_https="https://d3dy5gmtp8yhk7.cloudfront.net/",Pusher.dependency_suffix=".min",Pusher.getDefaultStrategy=function(e){return[[":def","ws_options",{hostUnencrypted:e.wsHost+":"+e.wsPort,hostEncrypted:e.wsHost+":"+e.wssPort}],[":def","sockjs_options",{hostUnencrypted:e.httpHost+":"+e.httpPort,hostEncrypted:e.httpHost+":"+e.httpsPort}],[":def","timeouts",{loop:!0,timeout:15e3,timeoutLimit:6e4}],[":def","ws_manager",[":transport_manager",{lives:2,minPingDelay:1e4,maxPingDelay:e.activity_timeout}]],[":def_transport","ws","ws",3,":ws_options",":ws_manager"],[":def_transport","flash","flash",2,":ws_options",":ws_manager"],[":def_transport","sockjs","sockjs",1,":sockjs_options"],[":def","ws_loop",[":sequential",":timeouts",":ws"]],[":def","flash_loop",[":sequential",":timeouts",":flash"]],[":def","sockjs_loop",[":sequential",":timeouts",":sockjs"]],[":def","strategy",[":cached",18e5,[":first_connected",[":if",[":is_supported",":ws"],[":best_connected_ever",":ws_loop",[":delayed",2e3,[":sockjs_loop"]]],[":if",[":is_supported",":flash"],[":best_connected_ever",":flash_loop",[":delayed",2e3,[":sockjs_loop"]]],[":sockjs_loop"]]]]]]]}}.call(this),function(){Pusher.getGlobalConfig=function(){return{wsHost:Pusher.host,wsPort:Pusher.ws_port,wssPort:Pusher.wss_port,httpHost:Pusher.sockjs_host,httpPort:Pusher.sockjs_http_port,httpsPort:Pusher.sockjs_https_port,httpPath:Pusher.sockjs_path,statsHost:Pusher.stats_host,authEndpoint:Pusher.channel_auth_endpoint,authTransport:Pusher.channel_auth_transport,activity_timeout:Pusher.activity_timeout,pong_timeout:Pusher.pong_timeout,unavailable_timeout:Pusher.unavailable_timeout}},Pusher.getClusterConfig=function(e){return{wsHost:"ws-"+e+".pusher.com",httpHost:"sockjs-"+e+".pusher.com"}}}.call(this),function(){function e(e){var t=function(t){Error.call(this,t),this.name=e};return Pusher.Util.extend(t.prototype,Error.prototype),t}Pusher.Errors={BadEventName:e("BadEventName"),UnsupportedTransport:e("UnsupportedTransport"),UnsupportedStrategy:e("UnsupportedStrategy"),TransportPriorityTooLow:e("TransportPriorityTooLow"),TransportClosed:e("TransportClosed")}}.call(this),function(){function e(e){this.callbacks=new t,this.global_callbacks=[],this.failThrough=e}function t(){this._callbacks={}}var n=e.prototype;n.bind=function(e,t){return this.callbacks.add(e,t),this},n.bind_all=function(e){return this.global_callbacks.push(e),this},n.unbind=function(e,t){return this.callbacks.remove(e,t),this},n.emit=function(e,t){var n;for(n=0;n<this.global_callbacks.length;n++)this.global_callbacks[n](e,t);var r=this.callbacks.get(e);if(r&&r.length>0)for(n=0;n<r.length;n++)r[n](t);else this.failThrough&&this.failThrough(e,t);return this},t.prototype.get=function(e){return this._callbacks[this._prefix(e)]},t.prototype.add=function(e,t){var n=this._prefix(e);this._callbacks[n]=this._callbacks[n]||[],this._callbacks[n].push(t)},t.prototype.remove=function(e,t){if(this.get(e)){var n=Pusher.Util.arrayIndexOf(this.get(e),t);if(-1!==n){var r=this._callbacks[this._prefix(e)].slice(0);r.splice(n,1),this._callbacks[this._prefix(e)]=r}}},t.prototype._prefix=function(e){return"_"+e},Pusher.EventsDispatcher=e}.call(this),function(){function e(e){this.options=e,this.loading={},this.loaded={}}function t(e,t){Pusher.Util.getDocument().addEventListener?e.addEventListener("load",t,!1):e.attachEvent("onreadystatechange",function(){("loaded"===e.readyState||"complete"===e.readyState)&&t()})}function n(e,n){var r=Pusher.Util.getDocument(),i=r.getElementsByTagName("head")[0],r=r.createElement("script");r.setAttribute("src",e),r.setAttribute("type","text/javascript"),r.setAttribute("async",!0),t(r,function(){setTimeout(n,0)}),i.appendChild(r)}var r=e.prototype;r.load=function(e,t){var r=this;this.loaded[e]?t():this.loading[e]&&this.loading[e].length>0?this.loading[e].push(t):(this.loading[e]=[t],n(this.getPath(e),function(){if(r.loaded[e]=!0,r.loading[e]){for(var t=0;t<r.loading[e].length;t++)r.loading[e][t]();delete r.loading[e]}}))},r.getRoot=function(e){var t=Pusher.Util.getDocumentLocation().protocol;return(e&&e.encrypted||"https:"===t?this.options.cdn_https:this.options.cdn_http).replace(/\/*$/,"")+"/"+this.options.version},r.getPath=function(e,t){return this.getRoot(t)+"/"+e+this.options.suffix+".js"},Pusher.DependencyLoader=e}.call(this),function(){function e(){Pusher.ready()}function t(e){document.body?e():setTimeout(function(){t(e)},0)}function n(){t(e)}Pusher.Dependencies=new Pusher.DependencyLoader({cdn_http:Pusher.cdn_http,cdn_https:Pusher.cdn_https,version:Pusher.VERSION,suffix:Pusher.dependency_suffix}),!window.WebSocket&&window.MozWebSocket&&(window.WebSocket=window.MozWebSocket),window.JSON?n():Pusher.Dependencies.load("json2",n)}(),function(){for(var e=String.fromCharCode,t=0;64>t;t++)"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(t);var n=function(t){var n=t.charCodeAt(0);return 128>n?t:2048>n?e(192|n>>>6)+e(128|63&n):e(224|n>>>12&15)+e(128|n>>>6&63)+e(128|63&n)},r=function(e){var t=[0,2,1][e.length%3],e=e.charCodeAt(0)<<16|(e.length>1?e.charCodeAt(1):0)<<8|(e.length>2?e.charCodeAt(2):0);return["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e>>>18),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e>>>12&63),t>=2?"=":"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e>>>6&63),t>=1?"=":"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(63&e)].join("")},i=window.btoa||function(e){return e.replace(/[\s\S]{1,3}/g,r)};Pusher.Base64={encode:function(e){return i(e.replace(/[^\x00-\x7F]/g,n))}}}.call(this),function(){function e(e){this.options=e}function t(e){return Pusher.Util.mapObject(e,function(e){return"object"==typeof e&&(e=JSON.stringify(e)),encodeURIComponent(Pusher.Base64.encode(e.toString()))})}e.send=function(e,t){var n=new Pusher.JSONPRequest({url:e.url,receiver:e.receiverName,tagPrefix:e.tagPrefix}),r=e.receiver.register(function(e,r){n.cleanup(),t(e,r)});return n.send(r,e.data,function(t){var n=e.receiver.unregister(r);n&&n(t)})};var n=e.prototype;n.send=function(e,n,r){if(this.script)return!1;var i=this.options.tagPrefix||"_pusher_jsonp_",n=Pusher.Util.extend({},n,{receiver:this.options.receiver}),n=Pusher.Util.map(Pusher.Util.flatten(t(Pusher.Util.filterObject(n,function(e){return void 0!==e}))),Pusher.Util.method("join","=")).join("&");this.script=document.createElement("script"),this.script.id=i+e,this.script.src=this.options.url+"/"+e+"?"+n,this.script.type="text/javascript",this.script.charset="UTF-8",this.script.onerror=this.script.onload=r,void 0===this.script.async&&document.attachEvent&&/opera/i.test(navigator.userAgent)&&(i=this.options.receiver||"Pusher.JSONP.receive",this.errorScript=document.createElement("script"),this.errorScript.text=i+"("+e+", true);",this.script.async=this.errorScript.async=!1);var o=this;return this.script.onreadystatechange=function(){o.script&&/loaded|complete/.test(o.script.readyState)&&r(!0)},e=document.getElementsByTagName("head")[0],e.insertBefore(this.script,e.firstChild),this.errorScript&&e.insertBefore(this.errorScript,this.script.nextSibling),!0},n.cleanup=function(){this.script&&this.script.parentNode&&(this.script.parentNode.removeChild(this.script),this.script=null),this.errorScript&&this.errorScript.parentNode&&(this.errorScript.parentNode.removeChild(this.errorScript),this.errorScript=null)},Pusher.JSONPRequest=e}.call(this),function(){function e(){this.lastId=0,this.callbacks={}}var t=e.prototype;t.register=function(e){this.lastId++;var t=this.lastId;return this.callbacks[t]=e,t},t.unregister=function(e){if(this.callbacks[e]){var t=this.callbacks[e];return delete this.callbacks[e],t}return null},t.receive=function(e,t,n){(e=this.unregister(e))&&e(t,n)},Pusher.JSONPReceiver=e,Pusher.JSONP=new e}.call(this),function(){function e(e,t,n){this.key=e,this.session=t,this.events=[],this.options=n||{},this.uniqueID=this.sent=0}var t=e.prototype;e.ERROR=3,e.INFO=6,e.DEBUG=7,t.log=function(t,n){(void 0===this.options.level||t<=this.options.level)&&(this.events.push(Pusher.Util.extend({},n,{timestamp:Pusher.Util.now(),level:t!==e.INFO?t:void 0})),this.options.limit&&this.events.length>this.options.limit&&this.events.shift())},t.error=function(t){this.log(e.ERROR,t)},t.info=function(t){this.log(e.INFO,t)},t.debug=function(t){this.log(e.DEBUG,t)},t.isEmpty=function(){return 0===this.events.length},t.send=function(e,t){var n=this,r=Pusher.Util.extend({session:n.session,bundle:n.sent+1,key:n.key,lib:"js",version:n.options.version,features:n.options.features,timeline:n.events},n.options.params);return n.events=[],e(r,function(e,r){e||n.sent++,t&&t(e,r)}),!0},t.generateUniqueID=function(){return this.uniqueID++,this.uniqueID},Pusher.Timeline=e}.call(this),function(){function e(e,t){this.timeline=e,this.options=t||{}}e.prototype.send=function(e,t){if(!this.timeline.isEmpty()){var n=this,r="http"+(e?"s":"")+"://";n.timeline.send(function(e,t){var i={data:Pusher.Util.filterObject(e,function(e){return void 0!==e}),url:r+(n.host||n.options.host)+n.options.path,receiver:Pusher.JSONP};return Pusher.JSONPRequest.send(i,function(e,r){r&&r.host&&(n.host=r.host),t&&t(e,r)})},t)}},Pusher.TimelineSender=e}.call(this),function(){function e(e){this.strategies=e}function t(e,t,n){var i=Pusher.Util.map(e,function(e,r,i,o){return e.connect(t,n(r,o))});return{abort:function(){Pusher.Util.apply(i,r)},forceMinPriority:function(e){Pusher.Util.apply(i,function(t){t.forceMinPriority(e)})}}}function n(e){return Pusher.Util.all(e,function(e){return Boolean(e.error)})}function r(e){e.error||e.aborted||(e.abort(),e.aborted=!0)}var i=e.prototype;i.isSupported=function(){return Pusher.Util.any(this.strategies,Pusher.Util.method("isSupported"))},i.connect=function(e,r){return t(this.strategies,e,function(e,t){return function(i,o){(t[e].error=i)?n(t)&&r(!0):(Pusher.Util.apply(t,function(e){e.forceMinPriority(o.transport.priority)}),r(null,o))}})},Pusher.BestConnectedEverStrategy=e}.call(this),function(){function e(e,t,n){this.strategy=e,this.transports=t,this.ttl=n.ttl||18e5,this.encrypted=n.encrypted,this.timeline=n.timeline}function t(e){return"pusherTransport"+(e?"Encrypted":"Unencrypted")}function n(e){var n=Pusher.Util.getLocalStorage();if(n)try{var i=n[t(e)];if(i)return JSON.parse(i)}catch(o){r(e)}return null}function r(e){var n=Pusher.Util.getLocalStorage();if(n)try{delete n[t(e)]}catch(r){}}var i=e.prototype;i.isSupported=function(){return this.strategy.isSupported()},i.connect=function(e,i){var o=this.encrypted,a=n(o),s=[this.strategy];if(a&&a.timestamp+this.ttl>=Pusher.Util.now()){var u=this.transports[a.transport];u&&(this.timeline.info({cached:!0,transport:a.transport}),s.push(new Pusher.SequentialStrategy([u],{timeout:2*a.latency,failFast:!0})))}var c=Pusher.Util.now(),l=s.pop().connect(e,function d(n,a){if(n)r(o),s.length>0?(c=Pusher.Util.now(),l=s.pop().connect(e,d)):i(n);else{var u=a.transport.name,h=Pusher.Util.now()-c,f=Pusher.Util.getLocalStorage();if(f)try{f[t(o)]=JSON.stringify({timestamp:Pusher.Util.now(),transport:u,latency:h})}catch(p){}i(null,a)}});return{abort:function(){l.abort()},forceMinPriority:function(t){e=t,l&&l.forceMinPriority(t)}}},Pusher.CachedStrategy=e}.call(this),function(){function e(e,t){this.strategy=e,this.options={delay:t.delay}}var t=e.prototype;t.isSupported=function(){return this.strategy.isSupported()},t.connect=function(e,t){var n,r=this.strategy,i=new Pusher.Timer(this.options.delay,function(){n=r.connect(e,t)});return{abort:function(){i.ensureAborted(),n&&n.abort()},forceMinPriority:function(t){e=t,n&&n.forceMinPriority(t)}}},Pusher.DelayedStrategy=e}.call(this),function(){function e(e){this.strategy=e}var t=e.prototype;t.isSupported=function(){return this.strategy.isSupported()},t.connect=function(e,t){var n=this.strategy.connect(e,function(e,r){r&&n.abort(),t(e,r)});return n},Pusher.FirstConnectedStrategy=e}.call(this),function(){function e(e,t,n){this.test=e,this.trueBranch=t,this.falseBranch=n}var t=e.prototype;t.isSupported=function(){return(this.test()?this.trueBranch:this.falseBranch).isSupported()},t.connect=function(e,t){return(this.test()?this.trueBranch:this.falseBranch).connect(e,t)},Pusher.IfStrategy=e}.call(this),function(){function e(e,t){this.strategies=e,this.loop=Boolean(t.loop),this.failFast=Boolean(t.failFast),this.timeout=t.timeout,this.timeoutLimit=t.timeoutLimit}var t=e.prototype;t.isSupported=function(){return Pusher.Util.any(this.strategies,Pusher.Util.method("isSupported"))},t.connect=function(e,t){var n=this,r=this.strategies,i=0,o=this.timeout,a=null,s=function(u,c){c?t(null,c):(i+=1,n.loop&&(i%=r.length),i<r.length?(o&&(o*=2,n.timeoutLimit&&(o=Math.min(o,n.timeoutLimit))),a=n.tryStrategy(r[i],e,{timeout:o,failFast:n.failFast},s)):t(!0))},a=this.tryStrategy(r[i],e,{timeout:o,failFast:this.failFast},s);return{abort:function(){a.abort()},forceMinPriority:function(t){e=t,a&&a.forceMinPriority(t)}}},t.tryStrategy=function(e,t,n,r){var i=null,o=null;return n.timeout>0&&(i=new Pusher.Timer(n.timeout,function(){o.abort(),r(!0)})),o=e.connect(t,function(e,t){e&&i&&i.isRunning()&&!n.failFast||(i&&i.ensureAborted(),r(e,t))}),{abort:function(){i&&i.ensureAborted(),o.abort()},forceMinPriority:function(e){o.forceMinPriority(e)}}},Pusher.SequentialStrategy=e}.call(this),function(){function e(e,t,n,r){this.name=e,this.priority=t,this.transport=n,this.options=r||{}}function t(e,t){return Pusher.Util.defer(function(){t(e)}),{abort:function(){},forceMinPriority:function(){}}}var n=e.prototype;n.isSupported=function(){return this.transport.isSupported()},n.connect=function(e,n){if(!this.isSupported())return t(new Pusher.Errors.UnsupportedStrategy,n);if(this.priority<e)return t(new Pusher.Errors.TransportPriorityTooLow,n);var r=this,i=!1,o=this.transport.createConnection(this.name,this.priority,this.options.key,this.options),a=null,s=function(){o.unbind("initialized",s),o.connect()},u=function(){a=new Pusher.Handshake(o,function(e){i=!0,d(),n(null,e)})},c=function(e){d(),n(e)},l=function(){d(),n(new Pusher.Errors.TransportClosed(o))},d=function(){o.unbind("initialized",s),o.unbind("open",u),o.unbind("error",c),o.unbind("closed",l)};return o.bind("initialized",s),o.bind("open",u),o.bind("error",c),o.bind("closed",l),o.initialize(),{abort:function(){i||(d(),a?a.close():o.close())},forceMinPriority:function(e){i||r.priority<e&&(a?a.close():o.close())}}},Pusher.TransportStrategy=e}.call(this),function(){function e(e,t,n,r){Pusher.EventsDispatcher.call(this),this.name=e,this.priority=t,this.key=n,this.state="new",this.timeline=r.timeline,this.activityTimeout=r.activityTimeout,this.id=this.timeline.generateUniqueID(),this.options={encrypted:Boolean(r.encrypted),hostUnencrypted:r.hostUnencrypted,hostEncrypted:r.hostEncrypted}}var t=e.prototype;Pusher.Util.extend(t,Pusher.EventsDispatcher.prototype),e.isSupported=function(){return!1},t.supportsPing=function(){return!1},t.initialize=function(){this.timeline.info(this.buildTimelineMessage({transport:this.name+(this.options.encrypted?"s":"")})),this.timeline.debug(this.buildTimelineMessage({method:"initialize"})),this.changeState("initialized")},t.connect=function(){var e=this.getURL(this.key,this.options);if(this.timeline.debug(this.buildTimelineMessage({method:"connect",url:e})),this.socket||"initialized"!==this.state)return!1;try{this.socket=this.createSocket(e)}catch(t){var n=this;return Pusher.Util.defer(function(){n.onError(t),n.changeState("closed")}),!1}return this.bindListeners(),Pusher.debug("Connecting",{transport:this.name,url:e}),this.changeState("connecting"),!0},t.close=function(){return this.timeline.debug(this.buildTimelineMessage({method:"close"})),this.socket?(this.socket.close(),!0):!1},t.send=function(e){if(this.timeline.debug(this.buildTimelineMessage({method:"send",data:e})),"open"===this.state){var t=this;return setTimeout(function(){t.socket&&t.socket.send(e)},0),!0}return!1},t.onOpen=function(){this.changeState("open"),this.socket.onopen=void 0},t.onError=function(e){this.emit("error",{type:"WebSocketError",error:e}),this.timeline.error(this.buildTimelineMessage({}))},t.onClose=function(e){e?this.changeState("closed",{code:e.code,reason:e.reason,wasClean:e.wasClean}):this.changeState("closed"),this.socket=void 0},t.onMessage=function(e){this.timeline.debug(this.buildTimelineMessage({message:e.data})),this.emit("message",e)},t.bindListeners=function(){var e=this;this.socket.onopen=function(){e.onOpen()},this.socket.onerror=function(t){e.onError(t)},this.socket.onclose=function(t){e.onClose(t)},this.socket.onmessage=function(t){e.onMessage(t)}},t.createSocket=function(){return null},t.getScheme=function(){return this.options.encrypted?"wss":"ws"},t.getBaseURL=function(){var e;return e=this.options.encrypted?this.options.hostEncrypted:this.options.hostUnencrypted,this.getScheme()+"://"+e},t.getPath=function(){return"/app/"+this.key},t.getQueryString=function(){return"?protocol="+Pusher.PROTOCOL+"&client=js&version="+Pusher.VERSION},t.getURL=function(){return this.getBaseURL()+this.getPath()+this.getQueryString()},t.changeState=function(e,t){this.state=e,this.timeline.info(this.buildTimelineMessage({state:e,params:t})),this.emit(e,t)},t.buildTimelineMessage=function(e){return Pusher.Util.extend({cid:this.id},e)},Pusher.AbstractTransport=e}.call(this),function(){function e(e,t,n,r){Pusher.AbstractTransport.call(this,e,t,n,r)}var t=e.prototype;Pusher.Util.extend(t,Pusher.AbstractTransport.prototype),e.createConnection=function(t,n,r,i){return new e(t,n,r,i)},e.isSupported=function(){try{return Boolean(new ActiveXObject("ShockwaveFlash.ShockwaveFlash"))}catch(e){try{return Boolean(navigator&&navigator.mimeTypes&&void 0!==navigator.mimeTypes["application/x-shockwave-flash"])}catch(t){return!1}}},t.initialize=function(){var e=this;this.timeline.info(this.buildTimelineMessage({transport:this.name+(this.options.encrypted?"s":"")})),this.timeline.debug(this.buildTimelineMessage({method:"initialize"})),this.changeState("initializing"),void 0===window.WEB_SOCKET_SUPPRESS_CROSS_DOMAIN_SWF_ERROR&&(window.WEB_SOCKET_SUPPRESS_CROSS_DOMAIN_SWF_ERROR=!0),window.WEB_SOCKET_SWF_LOCATION=Pusher.Dependencies.getRoot()+"/WebSocketMain.swf",Pusher.Dependencies.load("flashfallback",function(){e.changeState("initialized")})},t.createSocket=function(e){return new FlashWebSocket(e)},t.getQueryString=function(){return Pusher.AbstractTransport.prototype.getQueryString.call(this)+"&flash=true"},Pusher.FlashTransport=e}.call(this),function(){function e(e,t,n,r){Pusher.AbstractTransport.call(this,e,t,n,r),this.options.ignoreNullOrigin=r.ignoreNullOrigin}var t=e.prototype;Pusher.Util.extend(t,Pusher.AbstractTransport.prototype),e.createConnection=function(t,n,r,i){return new e(t,n,r,i)},e.isSupported=function(){return!0},t.initialize=function(){var e=this;this.timeline.info(this.buildTimelineMessage({transport:this.name+(this.options.encrypted?"s":"")})),this.timeline.debug(this.buildTimelineMessage({method:"initialize"})),this.changeState("initializing"),Pusher.Dependencies.load("sockjs",function(){e.changeState("initialized")})},t.supportsPing=function(){return!0},t.createSocket=function(e){return new SockJS(e,null,{js_path:Pusher.Dependencies.getPath("sockjs",{encrypted:this.options.encrypted}),ignore_null_origin:this.options.ignoreNullOrigin})},t.getScheme=function(){return this.options.encrypted?"https":"http"},t.getPath=function(){return this.options.httpPath||"/pusher"},t.getQueryString=function(){return""},t.onOpen=function(){this.socket.send(JSON.stringify({path:Pusher.AbstractTransport.prototype.getPath.call(this)+Pusher.AbstractTransport.prototype.getQueryString.call(this)})),this.changeState("open"),this.socket.onopen=void 0},Pusher.SockJSTransport=e}.call(this),function(){function e(e,t,n,r){Pusher.AbstractTransport.call(this,e,t,n,r)}var t=e.prototype;Pusher.Util.extend(t,Pusher.AbstractTransport.prototype),e.createConnection=function(t,n,r,i){return new e(t,n,r,i)},e.isSupported=function(){return void 0!==window.WebSocket||void 0!==window.MozWebSocket},t.createSocket=function(e){return new(window.WebSocket||window.MozWebSocket)(e)},t.getQueryString=function(){return Pusher.AbstractTransport.prototype.getQueryString.call(this)+"&flash=false"},Pusher.WSTransport=e}.call(this),function(){function e(e,t,n){this.manager=e,this.transport=t,this.minPingDelay=n.minPingDelay,this.maxPingDelay=n.maxPingDelay,this.pingDelay=void 0}var t=e.prototype;t.createConnection=function(e,t,n,r){var i=this,r=Pusher.Util.extend({},r,{activityTimeout:i.pingDelay}),o=i.transport.createConnection(e,t,n,r),a=null,s=function(){o.unbind("open",s),o.bind("closed",u),a=Pusher.Util.now()},u=function(e){o.unbind("closed",u),1002===e.code||1003===e.code?i.manager.reportDeath():!e.wasClean&&a&&(e=Pusher.Util.now()-a,e<2*i.maxPingDelay)&&(i.manager.reportDeath(),i.pingDelay=Math.max(e/2,i.minPingDelay))};return o.bind("open",s),o},t.isSupported=function(){return this.manager.isAlive()&&this.transport.isSupported()},Pusher.AssistantToTheTransportManager=e}.call(this),function(){function e(e){this.options=e||{},this.livesLeft=this.options.lives||1/0}var t=e.prototype;t.getAssistant=function(e){return new Pusher.AssistantToTheTransportManager(this,e,{minPingDelay:this.options.minPingDelay,maxPingDelay:this.options.maxPingDelay})},t.isAlive=function(){return this.livesLeft>0},t.reportDeath=function(){this.livesLeft-=1},Pusher.TransportManager=e}.call(this),function(){function e(e){return function(t){return[e.apply(this,arguments),t]}}function t(e,n){if(0===e.length)return[[],n];var i=r(e[0],n),o=t(e.slice(1),i[1]);return[[i[0]].concat(o[0]),o[1]]}function n(e,n){if("string"==typeof e[0]&&":"===e[0].charAt(0)){var i=n[e[0].slice(1)];if(e.length>1){if("function"!=typeof i)throw"Calling non-function "+e[0];var o=[Pusher.Util.extend({},n)].concat(Pusher.Util.map(e.slice(1),function(e){return r(e,Pusher.Util.extend({},n))[0]}));return i.apply(this,o)}return[i,n]}return t(e,n)}function r(e,t){if("string"==typeof e){var r;if("string"==typeof e&&":"===e.charAt(0)){if(r=t[e.slice(1)],void 0===r)throw"Undefined symbol "+e;r=[r,t]}else r=[e,t];return r}return"object"==typeof e&&e instanceof Array&&e.length>0?n(e,t):[e,t]}var i={ws:Pusher.WSTransport,flash:Pusher.FlashTransport,sockjs:Pusher.SockJSTransport},o={isSupported:function(){return!1},connect:function(e,t){var n=Pusher.Util.defer(function(){t(new Pusher.Errors.UnsupportedStrategy)});return{abort:function(){n.ensureAborted()},forceMinPriority:function(){}}}},a={def:function(e,t,n){if(void 0!==e[t])throw"Redefining symbol "+t;return e[t]=n,[void 0,e]},def_transport:function(e,t,n,r,a,s){var u=i[n];if(!u)throw new Pusher.Errors.UnsupportedTransport(n);return n=e.enabledTransports&&-1===Pusher.Util.arrayIndexOf(e.enabledTransports,t)||e.disabledTransports&&-1!==Pusher.Util.arrayIndexOf(e.disabledTransports,t)||"flash"===t&&e.disableFlash===!0?o:new Pusher.TransportStrategy(t,r,s?s.getAssistant(u):u,Pusher.Util.extend({key:e.key,encrypted:e.encrypted,timeline:e.timeline,ignoreNullOrigin:e.ignoreNullOrigin},a)),r=e.def(e,t,n)[1],r.transports=e.transports||{},r.transports[t]=n,[void 0,r]},transport_manager:e(function(e,t){return new Pusher.TransportManager(t)}),sequential:e(function(e,t){var n=Array.prototype.slice.call(arguments,2);return new Pusher.SequentialStrategy(n,t)}),cached:e(function(e,t,n){return new Pusher.CachedStrategy(n,e.transports,{ttl:t,timeline:e.timeline,encrypted:e.encrypted})}),first_connected:e(function(e,t){return new Pusher.FirstConnectedStrategy(t)}),best_connected_ever:e(function(){var e=Array.prototype.slice.call(arguments,1);return new Pusher.BestConnectedEverStrategy(e)}),delayed:e(function(e,t,n){return new Pusher.DelayedStrategy(n,{delay:t})}),"if":e(function(e,t,n,r){return new Pusher.IfStrategy(t,n,r)}),is_supported:e(function(e,t){return function(){return t.isSupported()}})};Pusher.StrategyBuilder={build:function(e,t){var n=Pusher.Util.extend({},a,t);return r(e,n)[1].strategy}}}.call(this),function(){Pusher.Protocol={decodeMessage:function(e){try{var t=JSON.parse(e.data);if("string"==typeof t.data)try{t.data=JSON.parse(t.data)}catch(n){if(!(n instanceof SyntaxError))throw n}return t}catch(r){throw{type:"MessageParseError",error:r,data:e.data}}},encodeMessage:function(e){return JSON.stringify(e)},processHandshake:function(e){if(e=this.decodeMessage(e),"pusher:connection_established"===e.event){if(!e.data.activity_timeout)throw"No activity timeout specified in handshake";return{action:"connected",id:e.data.socket_id,activityTimeout:1e3*e.data.activity_timeout}}if("pusher:error"===e.event)return{action:this.getCloseAction(e.data),error:this.getCloseError(e.data)};throw"Invalid handshake"},getCloseAction:function(e){return e.code<4e3?e.code>=1002&&e.code<=1004?"backoff":null:4e3===e.code?"ssl_only":e.code<4100?"refused":e.code<4200?"backoff":e.code<4300?"retry":"refused"},getCloseError:function(e){return 1e3!==e.code&&1001!==e.code?{type:"PusherError",data:{code:e.code,message:e.reason||e.message}}:null}}}.call(this),function(){function e(e,t){Pusher.EventsDispatcher.call(this),this.id=e,this.transport=t,this.activityTimeout=t.activityTimeout,this.bindListeners()}var t=e.prototype;Pusher.Util.extend(t,Pusher.EventsDispatcher.prototype),t.supportsPing=function(){return this.transport.supportsPing()},t.send=function(e){return this.transport.send(e)},t.send_event=function(e,t,n){return e={event:e,data:t},n&&(e.channel=n),Pusher.debug("Event sent",e),this.send(Pusher.Protocol.encodeMessage(e))
},t.close=function(){this.transport.close()},t.bindListeners=function(){var e=this,t=function(t){var n;try{n=Pusher.Protocol.decodeMessage(t)}catch(r){e.emit("error",{type:"MessageParseError",error:r,data:t.data})}if(void 0!==n){switch(Pusher.debug("Event recd",n),n.event){case"pusher:error":e.emit("error",{type:"PusherError",data:n.data});break;case"pusher:ping":e.emit("ping");break;case"pusher:pong":e.emit("pong")}e.emit("message",n)}},n=function(t){e.emit("error",{type:"WebSocketError",error:t})},r=function(i){e.transport.unbind("closed",r),e.transport.unbind("error",n),e.transport.unbind("message",t),i&&i.code&&e.handleCloseEvent(i),e.transport=null,e.emit("closed")};e.transport.bind("message",t),e.transport.bind("error",n),e.transport.bind("closed",r)},t.handleCloseEvent=function(e){var t=Pusher.Protocol.getCloseAction(e);(e=Pusher.Protocol.getCloseError(e))&&this.emit("error",e),t&&this.emit(t)},Pusher.Connection=e}.call(this),function(){function e(e,t){this.transport=e,this.callback=t,this.bindListeners()}var t=e.prototype;t.close=function(){this.unbindListeners(),this.transport.close()},t.bindListeners=function(){var e=this;e.onMessage=function(t){e.unbindListeners();try{var n=Pusher.Protocol.processHandshake(t);"connected"===n.action?e.finish("connected",{connection:new Pusher.Connection(n.id,e.transport),activityTimeout:n.activityTimeout}):(e.finish(n.action,{error:n.error}),e.transport.close())}catch(r){e.finish("error",{error:r}),e.transport.close()}},e.onClosed=function(t){e.unbindListeners();var n=Pusher.Protocol.getCloseAction(t)||"backoff",t=Pusher.Protocol.getCloseError(t);e.finish(n,{error:t})},e.transport.bind("message",e.onMessage),e.transport.bind("closed",e.onClosed)},t.unbindListeners=function(){this.transport.unbind("message",this.onMessage),this.transport.unbind("closed",this.onClosed)},t.finish=function(e,t){this.callback(Pusher.Util.extend({transport:this.transport,action:e},t))},Pusher.Handshake=e}.call(this),function(){function e(e,t){Pusher.EventsDispatcher.call(this),this.key=e,this.options=t||{},this.state="initialized",this.connection=null,this.encrypted=!!t.encrypted,this.timeline=this.options.timeline,this.connectionCallbacks=this.buildConnectionCallbacks(),this.errorCallbacks=this.buildErrorCallbacks(),this.handshakeCallbacks=this.buildHandshakeCallbacks(this.errorCallbacks);var n=this;Pusher.Network.bind("online",function(){n.timeline.info({netinfo:"online"}),("connecting"===n.state||"unavailable"===n.state)&&n.retryIn(0)}),Pusher.Network.bind("offline",function(){n.timeline.info({netinfo:"offline"}),"connected"===n.state&&n.sendActivityCheck()}),this.updateStrategy()}var t=e.prototype;Pusher.Util.extend(t,Pusher.EventsDispatcher.prototype),t.connect=function(){!this.connection&&!this.runner&&(this.strategy.isSupported()?(this.updateState("connecting"),this.startConnecting(),this.setUnavailableTimer()):this.updateState("failed"))},t.send=function(e){return this.connection?this.connection.send(e):!1},t.send_event=function(e,t,n){return this.connection?this.connection.send_event(e,t,n):!1},t.disconnect=function(){this.disconnectInternally(),this.updateState("disconnected")},t.isEncrypted=function(){return this.encrypted},t.startConnecting=function(){var e=this,t=function(n,r){n?e.runner=e.strategy.connect(0,t):"error"===r.action?(e.emit("error",{type:"HandshakeError",error:r.error}),e.timeline.error({handshakeError:r.error})):(e.abortConnecting(),e.handshakeCallbacks[r.action](r))};e.runner=e.strategy.connect(0,t)},t.abortConnecting=function(){this.runner&&(this.runner.abort(),this.runner=null)},t.disconnectInternally=function(){this.abortConnecting(),this.clearRetryTimer(),this.clearUnavailableTimer(),this.stopActivityCheck(),this.connection&&this.abandonConnection().close()},t.updateStrategy=function(){this.strategy=this.options.getStrategy({key:this.key,timeline:this.timeline,encrypted:this.encrypted})},t.retryIn=function(e){var t=this;t.timeline.info({action:"retry",delay:e}),e>0&&t.emit("connecting_in",Math.round(e/1e3)),t.retryTimer=new Pusher.Timer(e||0,function(){t.disconnectInternally(),t.connect()})},t.clearRetryTimer=function(){this.retryTimer&&(this.retryTimer.ensureAborted(),this.retryTimer=null)},t.setUnavailableTimer=function(){var e=this;e.unavailableTimer=new Pusher.Timer(e.options.unavailableTimeout,function(){e.updateState("unavailable")})},t.clearUnavailableTimer=function(){this.unavailableTimer&&this.unavailableTimer.ensureAborted()},t.sendActivityCheck=function(){var e=this;e.stopActivityCheck(),e.send_event("pusher:ping",{}),e.activityTimer=new Pusher.Timer(e.options.pongTimeout,function(){e.timeline.error({pong_timed_out:e.options.pongTimeout}),e.retryIn(0)})},t.resetActivityCheck=function(){var e=this;e.stopActivityCheck(),e.connection.supportsPing()||(e.activityTimer=new Pusher.Timer(e.activityTimeout,function(){e.sendActivityCheck()}))},t.stopActivityCheck=function(){this.activityTimer&&this.activityTimer.ensureAborted()},t.buildConnectionCallbacks=function(){var e=this;return{message:function(t){e.resetActivityCheck(),e.emit("message",t)},ping:function(){e.send_event("pusher:pong",{})},error:function(t){e.emit("error",{type:"WebSocketError",error:t})},closed:function(){e.abandonConnection(),e.shouldRetry()&&e.retryIn(1e3)}}},t.buildHandshakeCallbacks=function(e){var t=this;return Pusher.Util.extend({},e,{connected:function(e){t.activityTimeout=Math.min(t.options.activityTimeout,e.activityTimeout,e.connection.activityTimeout||1/0),t.clearUnavailableTimer(),t.setConnection(e.connection),t.socket_id=t.connection.id,t.updateState("connected",{socket_id:t.socket_id})}})},t.buildErrorCallbacks=function(){function e(e){return function(n){n.error&&t.emit("error",{type:"WebSocketError",error:n.error}),e(n)}}var t=this;return{ssl_only:e(function(){t.encrypted=!0,t.updateStrategy(),t.retryIn(0)}),refused:e(function(){t.disconnect()}),backoff:e(function(){t.retryIn(1e3)}),retry:e(function(){t.retryIn(0)})}},t.setConnection=function(e){this.connection=e;for(var t in this.connectionCallbacks)this.connection.bind(t,this.connectionCallbacks[t]);this.resetActivityCheck()},t.abandonConnection=function(){if(this.connection){for(var e in this.connectionCallbacks)this.connection.unbind(e,this.connectionCallbacks[e]);return e=this.connection,this.connection=null,e}},t.updateState=function(e,t){var n=this.state;this.state=e,n!==e&&(Pusher.debug("State changed",n+" -> "+e),this.timeline.info({state:e,params:t}),this.emit("state_change",{previous:n,current:e}),this.emit(e,t))},t.shouldRetry=function(){return"connecting"===this.state||"connected"===this.state},Pusher.ConnectionManager=e}.call(this),function(){function e(){Pusher.EventsDispatcher.call(this);var e=this;void 0!==window.addEventListener&&(window.addEventListener("online",function(){e.emit("online")},!1),window.addEventListener("offline",function(){e.emit("offline")},!1))}Pusher.Util.extend(e.prototype,Pusher.EventsDispatcher.prototype),e.prototype.isOnline=function(){return void 0===window.navigator.onLine?!0:window.navigator.onLine},Pusher.NetInfo=e,Pusher.Network=new e}.call(this),function(){function e(){this.reset()}var t=e.prototype;t.get=function(e){return Object.prototype.hasOwnProperty.call(this.members,e)?{id:e,info:this.members[e]}:null},t.each=function(e){var t=this;Pusher.Util.objectApply(t.members,function(n,r){e(t.get(r))})},t.setMyID=function(e){this.myID=e},t.onSubscription=function(e){this.members=e.presence.hash,this.count=e.presence.count,this.me=this.get(this.myID)},t.addMember=function(e){return null===this.get(e.user_id)&&this.count++,this.members[e.user_id]=e.user_info,this.get(e.user_id)},t.removeMember=function(e){var t=this.get(e.user_id);return t&&(delete this.members[e.user_id],this.count--),t},t.reset=function(){this.members={},this.count=0,this.me=this.myID=null},Pusher.Members=e}.call(this),function(){function e(e,t){Pusher.EventsDispatcher.call(this,function(t){Pusher.debug("No callbacks on "+e+" for "+t)}),this.name=e,this.pusher=t,this.subscribed=!1}var t=e.prototype;Pusher.Util.extend(t,Pusher.EventsDispatcher.prototype),t.authorize=function(e,t){return t(!1,{})},t.trigger=function(e,t){if(0!==e.indexOf("client-"))throw new Pusher.Errors.BadEventName("Event '"+e+"' does not start with 'client-'");return this.pusher.send_event(e,t,this.name)},t.disconnect=function(){this.subscribed=!1},t.handleEvent=function(e,t){0===e.indexOf("pusher_internal:")?"pusher_internal:subscription_succeeded"===e&&(this.subscribed=!0,this.emit("pusher:subscription_succeeded",t)):this.emit(e,t)},t.subscribe=function(){var e=this;e.authorize(e.pusher.connection.socket_id,function(t,n){t?e.handleEvent("pusher:subscription_error",n):e.pusher.send_event("pusher:subscribe",{auth:n.auth,channel_data:n.channel_data,channel:e.name})})},t.unsubscribe=function(){this.pusher.send_event("pusher:unsubscribe",{channel:this.name})},Pusher.Channel=e}.call(this),function(){function e(e,t){Pusher.Channel.call(this,e,t)}var t=e.prototype;Pusher.Util.extend(t,Pusher.Channel.prototype),t.authorize=function(e,t){return new Pusher.Channel.Authorizer(this,this.pusher.config).authorize(e,t)},Pusher.PrivateChannel=e}.call(this),function(){function e(e,t){Pusher.PrivateChannel.call(this,e,t),this.members=new Pusher.Members}var t=e.prototype;Pusher.Util.extend(t,Pusher.PrivateChannel.prototype),t.authorize=function(e,t){var n=this;Pusher.PrivateChannel.prototype.authorize.call(n,e,function(e,r){if(!e){if(void 0===r.channel_data)return Pusher.warn("Invalid auth response for channel '"+n.name+"', expected 'channel_data' field"),void t("Invalid auth response");var i=JSON.parse(r.channel_data);n.members.setMyID(i.user_id)}t(e,r)})},t.handleEvent=function(e,t){switch(e){case"pusher_internal:subscription_succeeded":this.members.onSubscription(t),this.subscribed=!0,this.emit("pusher:subscription_succeeded",this.members);break;case"pusher_internal:member_added":this.emit("pusher:member_added",this.members.addMember(t));break;case"pusher_internal:member_removed":var n=this.members.removeMember(t);n&&this.emit("pusher:member_removed",n);break;default:Pusher.PrivateChannel.prototype.handleEvent.call(this,e,t)}},t.disconnect=function(){this.members.reset(),Pusher.PrivateChannel.prototype.disconnect.call(this)},Pusher.PresenceChannel=e}.call(this),function(){function e(){this.channels={}}var t=e.prototype;t.add=function(e,t){return this.channels[e]||(this.channels[e]=0===e.indexOf("private-")?new Pusher.PrivateChannel(e,t):0===e.indexOf("presence-")?new Pusher.PresenceChannel(e,t):new Pusher.Channel(e,t)),this.channels[e]},t.all=function(){return Pusher.Util.values(this.channels)},t.find=function(e){return this.channels[e]},t.remove=function(e){var t=this.channels[e];return delete this.channels[e],t},t.disconnect=function(){Pusher.Util.objectApply(this.channels,function(e){e.disconnect()})},Pusher.Channels=e}.call(this),function(){Pusher.Channel.Authorizer=function(e,t){this.channel=e,this.type=t.authTransport,this.options=t,this.authOptions=(t||{}).auth||{}},Pusher.Channel.Authorizer.prototype={composeQuery:function(e){var t,e="&socket_id="+encodeURIComponent(e)+"&channel_name="+encodeURIComponent(this.channel.name);for(t in this.authOptions.params)e+="&"+encodeURIComponent(t)+"="+encodeURIComponent(this.authOptions.params[t]);return e},authorize:function(e,t){return Pusher.authorizers[this.type].call(this,e,t)}};var e=1;Pusher.auth_callbacks={},Pusher.authorizers={ajax:function(e,t){var n;n=Pusher.XHR?new Pusher.XHR:window.XMLHttpRequest?new window.XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),n.open("POST",this.options.authEndpoint,!0),n.setRequestHeader("Content-Type","application/x-www-form-urlencoded");for(var r in this.authOptions.headers)n.setRequestHeader(r,this.authOptions.headers[r]);return n.onreadystatechange=function(){if(4==n.readyState)if(200==n.status){var e,r=!1;try{e=JSON.parse(n.responseText),r=!0}catch(i){t(!0,"JSON returned from webapp was invalid, yet status code was 200. Data was: "+n.responseText)}r&&t(!1,e)}else Pusher.warn("Couldn't get auth info from your webapp",n.status),t(!0,n.status)},n.send(this.composeQuery(e)),n},jsonp:function(t,n){void 0!==this.authOptions.headers&&Pusher.warn("Warn","To send headers with the auth request, you must use AJAX, rather than JSONP.");var r=e.toString();e++;var i=Pusher.Util.getDocument(),o=i.createElement("script");Pusher.auth_callbacks[r]=function(e){n(!1,e)},o.src=this.options.authEndpoint+"?callback="+encodeURIComponent("Pusher.auth_callbacks['"+r+"']")+this.composeQuery(t),r=i.getElementsByTagName("head")[0]||i.documentElement,r.insertBefore(o,r.firstChild)}}}.call(this),function(){var e,t,n,r,i,o={}.hasOwnProperty,a=function(e,t){function n(){this.constructor=e}for(var r in t)o.call(t,r)&&(e[r]=t[r]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},s=this;for(this.Stripe=function(){function e(){}return e.version=2,e.endpoint="https://api.stripe.com/v1",e.setPublishableKey=function(t){e.key=t},e.complete=function(t){return function(n){var r;return"success"!==n?(r=Math.round((new Date).getTime()/1e3),(new Image).src="https://q.stripe.com?event=stripejs-error&type="+n+"&key="+e.key+"&timestamp="+r,"function"==typeof t?t(500,{error:{code:n,type:n,message:"An unexpected error has occurred submitting your credit\ncard to our secure credit card processor. This may be\ndue to network connectivity issues, so you should try\nagain (you won't be charged twice). If this problem\npersists, please let us know!"}}):void 0):void 0}},e}.call(this),e=this.Stripe,this.Stripe.token=function(){function t(){}return t.validate=function(e,t){if(!e)throw t+" required";if("object"!=typeof e)throw t+" invalid"},t.formatData=function(t,n){return e.utils.isElement(t)&&(t=e.utils.paramsFromForm(t,n)),e.utils.underscoreKeys(t),t},t.create=function(t,n){return t.key||(t.key=e.key||e.publishableKey),e.utils.validateKey(t.key),e.ajaxJSONP({url:""+e.endpoint+"/tokens",data:t,method:"POST",success:function(e,t){return"function"==typeof n?n(t,e):void 0},complete:e.complete(n),timeout:4e4})},t.get=function(t,n){if(!t)throw"token required";return e.utils.validateKey(e.key),e.ajaxJSONP({url:""+e.endpoint+"/tokens/"+t,data:{key:e.key},success:function(e,t){return"function"==typeof n?n(t,e):void 0},complete:e.complete(n),timeout:4e4})},t}.call(this),this.Stripe.card=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return a(n,t),n.tokenName="card",n.whitelistedAttrs=["number","cvc","exp_month","exp_year","name","address_line1","address_line2","address_city","address_state","address_zip","address_country"],n.createToken=function(t,r,i){var o;return null==r&&(r={}),e.token.validate(t,"card"),"function"==typeof r?(i=r,r={}):"object"!=typeof r&&(o=parseInt(r,10),r={},o>0&&(r.amount=o)),r[n.tokenName]=e.token.formatData(t,n.whitelistedAttrs),e.token.create(r,i)},n.getToken=function(t,n){return e.token.get(t,n)},n.validateCardNumber=function(e){return e=(e+"").replace(/\s+|-/g,""),e.length>=10&&e.length<=16&&n.luhnCheck(e)},n.validateCVC=function(t){return t=e.utils.trim(t),/^\d+$/.test(t)&&t.length>=3&&t.length<=4},n.validateExpiry=function(t,n){var r,i;return t=e.utils.trim(t),n=e.utils.trim(n),/^\d+$/.test(t)&&/^\d+$/.test(n)&&parseInt(t,10)<=12?(i=new Date(n,t),r=new Date,i.setMonth(i.getMonth()-1),i.setMonth(i.getMonth()+1,1),i>r):!1},n.luhnCheck=function(e){var t,n,r,i,o,a;for(r=!0,i=0,n=(e+"").split("").reverse(),o=0,a=n.length;a>o;o++)t=n[o],t=parseInt(t,10),(r=!r)&&(t*=2),t>9&&(t-=9),i+=t;return i%10===0},n.cardType=function(e){return n.cardTypes[e.slice(0,2)]||"Unknown"},n.cardTypes=function(){var e,t,n,r;for(t={},e=n=40;49>=n;e=++n)t[e]="Visa";for(e=r=50;59>=r;e=++r)t[e]="MasterCard";return t[34]=t[37]="American Express",t[60]=t[62]=t[64]=t[65]="Discover",t[35]="JCB",t[30]=t[36]=t[38]=t[39]="Diners Club",t}(),n}.call(this,this.Stripe.token),this.Stripe.bankAccount=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return a(n,t),n.tokenName="bank_account",n.whitelistedAttrs=["country","routing_number","account_number"],n.createToken=function(t,r,i){return null==r&&(r={}),e.token.validate(t,"bank account"),"function"==typeof r&&(i=r,r={}),r[n.tokenName]=e.token.formatData(t,n.whitelistedAttrs),e.token.create(r,i)},n.getToken=function(t,n){return e.token.get(t,n)},n.validateRoutingNumber=function(t,r){switch(t=e.utils.trim(t),r){case"US":return/^\d+$/.test(t)&&9===t.length&&n.routingChecksum(t);case"CA":return/\d{5}\-\d{3}/.test(t)&&9===t.length;default:return!0}},n.validateAccountNumber=function(t,n){switch(t=e.utils.trim(t),n){case"US":return/^\d+$/.test(t)&&t.length>=1&&t.length<=17;default:return!0}},n.routingChecksum=function(e){var t,n,r,i,o,a;for(r=0,t=(e+"").split(""),a=[0,3,6],i=0,o=a.length;o>i;i++)n=a[i],r+=3*parseInt(t[n]),r+=7*parseInt(t[n+1]),r+=parseInt(t[n+2]);return 0!==r&&r%10===0},n}.call(this,this.Stripe.token),t=["createToken","getToken","cardType","validateExpiry","validateCVC","validateCardNumber"],r=0,i=t.length;i>r;r++)n=t[r],this.Stripe[n]=this.Stripe.card[n];"undefined"!=typeof module&&null!==module&&(module.exports=this.Stripe),"function"==typeof define&&define("stripe",[],function(){return s.Stripe})}.call(this),function(){var e,t,n,r=[].slice;e=encodeURIComponent,t=(new Date).getTime(),n=function(t,r,i){var o,a;null==r&&(r=[]);for(o in t)a=t[o],i&&(o=""+i+"["+o+"]"),"object"==typeof a?n(a,r,o):r.push(""+o+"="+e(a));return r.join("&").replace(/%20/g,"+")},this.Stripe.ajaxJSONP=function(e){var i,o,a,s,u,c;return null==e&&(e={}),a="sjsonp"+ ++t,u=document.createElement("script"),o=null,i=function(t){var n;return null==t&&(t="abort"),clearTimeout(o),null!=(n=u.parentNode)&&n.removeChild(u),a in window&&(window[a]=function(){}),"function"==typeof e.complete?e.complete(t,c,e):void 0},c={abort:i},u.onerror=function(){return c.abort(),"function"==typeof e.error?e.error(c,e):void 0},window[a]=function(){var t;t=1<=arguments.length?r.call(arguments,0):[],clearTimeout(o),u.parentNode.removeChild(u);try{delete window[a]}catch(n){window[a]=void 0}return"function"==typeof e.success&&e.success.apply(e,t),"function"==typeof e.complete?e.complete("success",c,e):void 0},e.data||(e.data={}),e.data.callback=a,e.method&&(e.data._method=e.method),u.src=e.url+"?"+n(e.data),s=document.getElementsByTagName("head")[0],s.appendChild(u),e.timeout>0&&(o=setTimeout(function(){return c.abort("timeout")},e.timeout)),c}}.call(this),function(){var e=[].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(t in this&&this[t]===e)return t;return-1};this.Stripe.utils=function(){function t(){}return t.trim=function(e){return(e+"").replace(/^\s+|\s+$/g,"")},t.underscore=function(e){return(e+"").replace(/([A-Z])/g,function(e){return"_"+e.toLowerCase()}).replace(/-/g,"_")},t.underscoreKeys=function(e){var t,n,r;r=[];for(t in e)n=e[t],delete e[t],r.push(e[this.underscore(t)]=n);return r},t.isElement=function(e){return"object"!=typeof e?!1:"undefined"!=typeof jQuery&&null!==jQuery&&e instanceof jQuery?!0:1===e.nodeType},t.paramsFromForm=function(t,n){var r,i,o,a,s,u,c,l,d,h;for(null==n&&(n=[]),"undefined"!=typeof jQuery&&null!==jQuery&&t instanceof jQuery&&(t=t[0]),o=t.getElementsByTagName("input"),s=t.getElementsByTagName("select"),u={},c=0,d=o.length;d>c;c++)i=o[c],r=this.underscore(i.getAttribute("data-stripe")),e.call(n,r)<0||(u[r]=i.value);for(l=0,h=s.length;h>l;l++)a=s[l],r=this.underscore(a.getAttribute("data-stripe")),e.call(n,r)<0||null!=a.selectedIndex&&(u[r]=a.options[a.selectedIndex].value);return u},t.validateKey=function(e){if(!e||"string"!=typeof e)throw new Error("You did not set a valid publishable key. Call Stripe.setPublishableKey() with your publishable key. For more info, see https://stripe.com/docs/stripe.js");if(/\s/g.test(e))throw new Error("Your key is invalid, as it contains whitespace. For more info, see https://stripe.com/docs/stripe.js");if(/^sk_/.test(e))throw new Error("You are using a secret key with Stripe.js, instead of the publishable one. For more info, see https://stripe.com/docs/stripe.js")},t}()}.call(this),function(){var e=[].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(t in this&&this[t]===e)return t;return-1};this.Stripe.validator={"boolean":function(e,t){return"true"!==t&&"false"!==t?"Enter a boolean string (true or false)":void 0},integer:function(e,t){return/^\d+$/.test(t)?void 0:"Enter an integer"},positive:function(e,t){return!this.integer(e,t)&&parseInt(t,10)>0?void 0:"Enter a positive value"},range:function(t,n){var r;return r=parseInt(n,10),e.call(t,r)<0?"Needs to be between "+t[0]+" and "+t[t.length-1]:void 0},required:function(e,t){return!e||null!=t&&""!==t?void 0:"Required"},year:function(e,t){return/^\d{4}$/.test(t)?void 0:"Enter a 4-digit year"},birthYear:function(e,t){var n;return n=this.year(e,t),n?n:parseInt(t,10)>2e3?"You must be over 18":parseInt(t,10)<1900?"Enter your birth year":void 0},month:function(e,t){return this.integer(e,t)?"Please enter a month":this.range([1,2,3,4,5,6,7,8,9,10,11,12],t)?"Needs to be between 1 and 12":void 0},choices:function(t,n){return e.call(t,n)<0?"Not an acceptable value for this field":void 0},email:function(e,t){return/^[^@<\s>]+@[^@<\s>]+$/.test(t)?void 0:"That doesn't look like an email address"},url:function(e,t){return/^https?:\/\/.+\..+/.test(t)?void 0:"Not a valid url"},usTaxID:function(e,t){return/^\d{2}-?\d{1}-?\d{2}-?\d{4}$/.test(t)?void 0:"Not a valid tax ID"},ein:function(e,t){return/^\d{2}-?\d{7}$/.test(t)?void 0:"Not a valid EIN"},ssnLast4:function(e,t){return/^\d{4}$/.test(t)?void 0:"Not a valid last 4 digits for an SSN"},ownerPersonalID:function(e,t){var n;return n=function(){switch(e){case"CA":return/^\d{3}-?\d{3}-?\d{3}$/.test(t);case"US":return!0}}(),n?void 0:"Not a valid ID"},bizTaxID:function(e,t){var n,r,i,o,a,s,u,c;if(s={CA:["Tax ID",[/^\d{9}$/]],US:["EIN",[/^\d{2}-?\d{7}$/]]},a=s[e],null!=a){for(n=a[0],o=a[1],r=!1,u=0,c=o.length;c>u;u++)if(i=o[u],i.test(t)){r=!0;break}if(!r)return"Not a valid "+n}},zip:function(e,t){var n;return n=function(){switch(e.toUpperCase()){case"CA":return/^[\d\w]{6}$/.test(null!=t?t.replace(/\s+/g,""):void 0);case"US":return/^\d{5}$/.test(t)||/^\d{9}$/.test(t)}}(),n?void 0:"Not a valid zip"},bankAccountNumber:function(e,t){return/^\d{1,17}$/.test(t)?void 0:"Invalid bank account number"},usRoutingNumber:function(e){var t,n,r,i,o,a,s;if(!/^\d{9}$/.test(e))return"Routing number must have 9 digits";for(o=0,t=a=0,s=e.length-1;s>=a;t=a+=3)n=3*parseInt(e.charAt(t),10),r=7*parseInt(e.charAt(t+1),10),i=parseInt(e.charAt(t+2),10),o+=n+r+i;return 0===o||o%10!==0?"Invalid routing number":void 0},caRoutingNumber:function(e){return/^\d{5}\-\d{3}$/.test(e)?void 0:"Invalid transit number"},routingNumber:function(e,t){switch(e.toUpperCase()){case"CA":return this.caRoutingNumber(t);case"US":return this.usRoutingNumber(t)}},phoneNumber:function(e,t){var n;return n=t.replace(/[^0-9]/g,""),10!==n.length?"Invalid phone number":void 0},bizDBA:function(e,t){return/^.{1,23}$/.test(t)?void 0:"Statement descriptors can only have up to 23 characters"},nameLength:function(e,t){return 1===t.length?"Names need to be longer than one character":void 0}}}.call(this),function(){!function(e){var t=this||(0,eval)("this"),n=t.document,r=t.navigator,i=t.jQuery,o=t.JSON;!function(e){"function"==typeof require&&"object"==typeof exports&&"object"==typeof module?e(module.exports||exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.ko={})}(function(a){function s(e,t){return null===e||typeof e in h?e===t:!1}function u(t,n){var r;return function(){r||(r=setTimeout(function(){r=e,t()},n))}}function c(e,t){var n;return function(){clearTimeout(n),n=setTimeout(e,t)}}function l(e,t,n,r){d.d[e]={init:function(e,i,o,a,s){var u,c;return d.ba(function(){var o=d.a.c(i()),a=!n!=!o,l=!c;(l||t||a!==u)&&(l&&d.ca.fa()&&(c=d.a.lb(d.e.childNodes(e),!0)),a?(l||d.e.U(e,d.a.lb(c)),d.gb(r?r(s,o):s,e)):d.e.da(e),u=a)},null,{G:e}),{controlsDescendantBindings:!0}}},d.g.aa[e]=!1,d.e.Q[e]=!0}var d="undefined"!=typeof a?a:{};d.b=function(e,t){for(var n=e.split("."),r=d,i=0;i<n.length-1;i++)r=r[n[i]];r[n[n.length-1]]=t},d.s=function(e,t,n){e[t]=n},d.version="3.1.0",d.b("version",d.version),d.a=function(){function a(e,t){for(var n in e)e.hasOwnProperty(n)&&t(n,e[n])}function s(e,t){if(t)for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function u(e,t){return e.__proto__=t,e}var c={__proto__:[]}instanceof Array,l={},h={};l[r&&/Firefox\/2/i.test(r.userAgent)?"KeyboardEvent":"UIEvents"]=["keyup","keydown","keypress"],l.MouseEvents="click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave".split(" "),a(l,function(e,t){if(t.length)for(var n=0,r=t.length;r>n;n++)h[t[n]]=e});var f={propertychange:!0},p=n&&function(){for(var t=3,r=n.createElement("div"),i=r.getElementsByTagName("i");r.innerHTML="<!--[if gt IE "+ ++t+"]><i></i><![endif]-->",i[0];);return t>4?t:e}();return{mb:["authenticity_token",/^__RequestVerificationToken(_.*)?$/],r:function(e,t){for(var n=0,r=e.length;r>n;n++)t(e[n],n)},l:function(e,t){if("function"==typeof Array.prototype.indexOf)return Array.prototype.indexOf.call(e,t);for(var n=0,r=e.length;r>n;n++)if(e[n]===t)return n;return-1},hb:function(e,t,n){for(var r=0,i=e.length;i>r;r++)if(t.call(n,e[r],r))return e[r];return null},ma:function(e,t){var n=d.a.l(e,t);n>0?e.splice(n,1):0===n&&e.shift()},ib:function(e){e=e||[];for(var t=[],n=0,r=e.length;r>n;n++)0>d.a.l(t,e[n])&&t.push(e[n]);return t},ya:function(e,t){e=e||[];for(var n=[],r=0,i=e.length;i>r;r++)n.push(t(e[r],r));return n},la:function(e,t){e=e||[];for(var n=[],r=0,i=e.length;i>r;r++)t(e[r],r)&&n.push(e[r]);return n},$:function(e,t){if(t instanceof Array)e.push.apply(e,t);else for(var n=0,r=t.length;r>n;n++)e.push(t[n]);return e},Y:function(e,t,n){var r=d.a.l(d.a.Sa(e),t);0>r?n&&e.push(t):n||e.splice(r,1)},na:c,extend:s,ra:u,sa:c?u:s,A:a,Oa:function(e,t){if(!e)return e;var n,r={};for(n in e)e.hasOwnProperty(n)&&(r[n]=t(e[n],n,e));return r},Fa:function(e){for(;e.firstChild;)d.removeNode(e.firstChild)},ec:function(e){e=d.a.R(e);for(var t=n.createElement("div"),r=0,i=e.length;i>r;r++)t.appendChild(d.M(e[r]));return t},lb:function(e,t){for(var n=0,r=e.length,i=[];r>n;n++){var o=e[n].cloneNode(!0);i.push(t?d.M(o):o)}return i},U:function(e,t){if(d.a.Fa(e),t)for(var n=0,r=t.length;r>n;n++)e.appendChild(t[n])},Bb:function(e,t){var n=e.nodeType?[e]:e;if(0<n.length){for(var r=n[0],i=r.parentNode,o=0,a=t.length;a>o;o++)i.insertBefore(t[o],r);for(o=0,a=n.length;a>o;o++)d.removeNode(n[o])}},ea:function(e,t){if(e.length){for(t=8===t.nodeType&&t.parentNode||t;e.length&&e[0].parentNode!==t;)e.shift();if(1<e.length){var n=e[0],r=e[e.length-1];for(e.length=0;n!==r;)if(e.push(n),n=n.nextSibling,!n)return;e.push(r)}}return e},Db:function(e,t){7>p?e.setAttribute("selected",t):e.selected=t},ta:function(t){return null===t||t===e?"":t.trim?t.trim():t.toString().replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")},oc:function(e,t){for(var n=[],r=(e||"").split(t),i=0,o=r.length;o>i;i++){var a=d.a.ta(r[i]);""!==a&&n.push(a)}return n},kc:function(e,t){return e=e||"",t.length>e.length?!1:e.substring(0,t.length)===t},Sb:function(e,t){if(e===t)return!0;if(11===e.nodeType)return!1;if(t.contains)return t.contains(3===e.nodeType?e.parentNode:e);if(t.compareDocumentPosition)return 16==(16&t.compareDocumentPosition(e));for(;e&&e!=t;)e=e.parentNode;return!!e},Ea:function(e){return d.a.Sb(e,e.ownerDocument.documentElement)},eb:function(e){return!!d.a.hb(e,d.a.Ea)},B:function(e){return e&&e.tagName&&e.tagName.toLowerCase()},q:function(e,t,n){var r=p&&f[t];if(!r&&i)i(e).bind(t,n);else if(r||"function"!=typeof e.addEventListener){if("undefined"==typeof e.attachEvent)throw Error("Browser doesn't support addEventListener or attachEvent");var o=function(t){n.call(e,t)},a="on"+t;e.attachEvent(a,o),d.a.u.ja(e,function(){e.detachEvent(a,o)})}else e.addEventListener(t,n,!1)},ha:function(e,r){if(!e||!e.nodeType)throw Error("element must be a DOM node when calling triggerEvent");var o;if("input"===d.a.B(e)&&e.type&&"click"==r.toLowerCase()?(o=e.type,o="checkbox"==o||"radio"==o):o=!1,i&&!o)i(e).trigger(r);else if("function"==typeof n.createEvent){if("function"!=typeof e.dispatchEvent)throw Error("The supplied element doesn't support dispatchEvent");o=n.createEvent(h[r]||"HTMLEvents"),o.initEvent(r,!0,!0,t,0,0,0,0,0,!1,!1,!1,!1,0,e),e.dispatchEvent(o)}else if(o&&e.click)e.click();else{if("undefined"==typeof e.fireEvent)throw Error("Browser doesn't support triggering events");e.fireEvent("on"+r)}},c:function(e){return d.v(e)?e():e},Sa:function(e){return d.v(e)?e.o():e},ua:function(e,t,n){if(t){var r=/\S+/g,i=e.className.match(r)||[];d.a.r(t.match(r),function(e){d.a.Y(i,e,n)}),e.className=i.join(" ")}},Xa:function(t,n){var r=d.a.c(n);(null===r||r===e)&&(r="");var i=d.e.firstChild(t);!i||3!=i.nodeType||d.e.nextSibling(i)?d.e.U(t,[t.ownerDocument.createTextNode(r)]):i.data=r,d.a.Vb(t)},Cb:function(e,t){if(e.name=t,7>=p)try{e.mergeAttributes(n.createElement("<input name='"+e.name+"'/>"),!1)}catch(r){}},Vb:function(e){p>=9&&(e=1==e.nodeType?e:e.parentNode,e.style&&(e.style.zoom=e.style.zoom))},Tb:function(e){if(p){var t=e.style.width;e.style.width=0,e.style.width=t}},ic:function(e,t){e=d.a.c(e),t=d.a.c(t);for(var n=[],r=e;t>=r;r++)n.push(r);return n},R:function(e){for(var t=[],n=0,r=e.length;r>n;n++)t.push(e[n]);return t},mc:6===p,nc:7===p,oa:p,ob:function(e,t){for(var n=d.a.R(e.getElementsByTagName("input")).concat(d.a.R(e.getElementsByTagName("textarea"))),r="string"==typeof t?function(e){return e.name===t}:function(e){return t.test(e.name)},i=[],o=n.length-1;o>=0;o--)r(n[o])&&i.push(n[o]);return i},fc:function(e){return"string"==typeof e&&(e=d.a.ta(e))?o&&o.parse?o.parse(e):new Function("return "+e)():null},Ya:function(e,t,n){if(!o||!o.stringify)throw Error("Cannot find JSON.stringify(). Some browsers (e.g., IE < 8) don't support it natively, but you can overcome this by adding a script reference to json2.js, downloadable from http://www.json.org/json2.js");return o.stringify(d.a.c(e),t,n)},gc:function(e,t,r){r=r||{};var i=r.params||{},o=r.includeFields||this.mb,s=e;if("object"==typeof e&&"form"===d.a.B(e))for(var s=e.action,u=o.length-1;u>=0;u--)for(var c=d.a.ob(e,o[u]),l=c.length-1;l>=0;l--)i[c[l].name]=c[l].value;t=d.a.c(t);var h=n.createElement("form");h.style.display="none",h.action=s,h.method="post";for(var f in t)e=n.createElement("input"),e.name=f,e.value=d.a.Ya(d.a.c(t[f])),h.appendChild(e);a(i,function(e,t){var r=n.createElement("input");r.name=e,r.value=t,h.appendChild(r)}),n.body.appendChild(h),r.submitter?r.submitter(h):h.submit(),setTimeout(function(){h.parentNode.removeChild(h)},0)}}}(),d.b("utils",d.a),d.b("utils.arrayForEach",d.a.r),d.b("utils.arrayFirst",d.a.hb),d.b("utils.arrayFilter",d.a.la),d.b("utils.arrayGetDistinctValues",d.a.ib),d.b("utils.arrayIndexOf",d.a.l),d.b("utils.arrayMap",d.a.ya),d.b("utils.arrayPushAll",d.a.$),d.b("utils.arrayRemoveItem",d.a.ma),d.b("utils.extend",d.a.extend),d.b("utils.fieldsIncludedWithJsonPost",d.a.mb),d.b("utils.getFormFields",d.a.ob),d.b("utils.peekObservable",d.a.Sa),d.b("utils.postJson",d.a.gc),d.b("utils.parseJson",d.a.fc),d.b("utils.registerEventHandler",d.a.q),d.b("utils.stringifyJson",d.a.Ya),d.b("utils.range",d.a.ic),d.b("utils.toggleDomNodeCssClass",d.a.ua),d.b("utils.triggerEvent",d.a.ha),d.b("utils.unwrapObservable",d.a.c),d.b("utils.objectForEach",d.a.A),d.b("utils.addOrRemoveItem",d.a.Y),d.b("unwrap",d.a.c),Function.prototype.bind||(Function.prototype.bind=function(e){var t=this,n=Array.prototype.slice.call(arguments);return e=n.shift(),function(){return t.apply(e,n.concat(Array.prototype.slice.call(arguments)))}}),d.a.f=new function(){function t(t,o){var a=t[r];if(!a||"null"===a||!i[a]){if(!o)return e;a=t[r]="ko"+n++,i[a]={}}return i[a]}var n=0,r="__ko__"+(new Date).getTime(),i={};return{get:function(n,r){var i=t(n,!1);return i===e?e:i[r]},set:function(n,r,i){(i!==e||t(n,!1)!==e)&&(t(n,!0)[r]=i)},clear:function(e){var t=e[r];
return t?(delete i[t],e[r]=null,!0):!1},L:function(){return n++ +r}}},d.b("utils.domData",d.a.f),d.b("utils.domData.clear",d.a.f.clear),d.a.u=new function(){function t(t,n){var i=d.a.f.get(t,r);return i===e&&n&&(i=[],d.a.f.set(t,r,i)),i}function n(e){var r=t(e,!1);if(r)for(var r=r.slice(0),i=0;i<r.length;i++)r[i](e);if(d.a.f.clear(e),d.a.u.cleanExternalData(e),a[e.nodeType])for(r=e.firstChild;e=r;)r=e.nextSibling,8===e.nodeType&&n(e)}var r=d.a.f.L(),o={1:!0,8:!0,9:!0},a={1:!0,9:!0};return{ja:function(e,n){if("function"!=typeof n)throw Error("Callback must be a function");t(e,!0).push(n)},Ab:function(n,i){var o=t(n,!1);o&&(d.a.ma(o,i),0==o.length&&d.a.f.set(n,r,e))},M:function(e){if(o[e.nodeType]&&(n(e),a[e.nodeType])){var t=[];d.a.$(t,e.getElementsByTagName("*"));for(var r=0,i=t.length;i>r;r++)n(t[r])}return e},removeNode:function(e){d.M(e),e.parentNode&&e.parentNode.removeChild(e)},cleanExternalData:function(e){i&&"function"==typeof i.cleanData&&i.cleanData([e])}}},d.M=d.a.u.M,d.removeNode=d.a.u.removeNode,d.b("cleanNode",d.M),d.b("removeNode",d.removeNode),d.b("utils.domNodeDisposal",d.a.u),d.b("utils.domNodeDisposal.addDisposeCallback",d.a.u.ja),d.b("utils.domNodeDisposal.removeDisposeCallback",d.a.u.Ab),function(){d.a.Qa=function(e){var r;if(i){if(i.parseHTML)r=i.parseHTML(e)||[];else if((r=i.clean([e]))&&r[0]){for(e=r[0];e.parentNode&&11!==e.parentNode.nodeType;)e=e.parentNode;e.parentNode&&e.parentNode.removeChild(e)}}else{var o=d.a.ta(e).toLowerCase();for(r=n.createElement("div"),o=o.match(/^<(thead|tbody|tfoot)/)&&[1,"<table>","</table>"]||!o.indexOf("<tr")&&[2,"<table><tbody>","</tbody></table>"]||(!o.indexOf("<td")||!o.indexOf("<th"))&&[3,"<table><tbody><tr>","</tr></tbody></table>"]||[0,"",""],e="ignored<div>"+o[1]+e+o[2]+"</div>","function"==typeof t.innerShiv?r.appendChild(t.innerShiv(e)):r.innerHTML=e;o[0]--;)r=r.lastChild;r=d.a.R(r.lastChild.childNodes)}return r},d.a.Va=function(t,n){if(d.a.Fa(t),n=d.a.c(n),null!==n&&n!==e)if("string"!=typeof n&&(n=n.toString()),i)i(t).html(n);else for(var r=d.a.Qa(n),o=0;o<r.length;o++)t.appendChild(r[o])}}(),d.b("utils.parseHtmlFragment",d.a.Qa),d.b("utils.setHtml",d.a.Va),d.w=function(){function t(e,n){if(e)if(8==e.nodeType){var r=d.w.xb(e.nodeValue);null!=r&&n.push({Rb:e,cc:r})}else if(1==e.nodeType)for(var r=0,i=e.childNodes,o=i.length;o>r;r++)t(i[r],n)}var n={};return{Na:function(e){if("function"!=typeof e)throw Error("You can only pass a function to ko.memoization.memoize()");var t=(4294967296*(1+Math.random())|0).toString(16).substring(1)+(4294967296*(1+Math.random())|0).toString(16).substring(1);return n[t]=e,"<!--[ko_memo:"+t+"]-->"},Hb:function(t,r){var i=n[t];if(i===e)throw Error("Couldn't find any memo with ID "+t+". Perhaps it's already been unmemoized.");try{return i.apply(null,r||[]),!0}finally{delete n[t]}},Ib:function(e,n){var r=[];t(e,r);for(var i=0,o=r.length;o>i;i++){var a=r[i].Rb,s=[a];n&&d.a.$(s,n),d.w.Hb(r[i].cc,s),a.nodeValue="",a.parentNode&&a.parentNode.removeChild(a)}},xb:function(e){return(e=e.match(/^\[ko_memo\:(.*?)\]$/))?e[1]:null}}}(),d.b("memoization",d.w),d.b("memoization.memoize",d.w.Na),d.b("memoization.unmemoize",d.w.Hb),d.b("memoization.parseMemoText",d.w.xb),d.b("memoization.unmemoizeDomNodeAndDescendants",d.w.Ib),d.Ga={throttle:function(e,t){e.throttleEvaluation=t;var n=null;return d.h({read:e,write:function(r){clearTimeout(n),n=setTimeout(function(){e(r)},t)}})},rateLimit:function(e,t){var n,r,i;"number"==typeof t?n=t:(n=t.timeout,r=t.method),i="notifyWhenChangesStop"==r?c:u,e.Ma(function(e){return i(e,n)})},notify:function(e,t){e.equalityComparer="always"==t?null:s}};var h={undefined:1,"boolean":1,number:1,string:1};d.b("extenders",d.Ga),d.Fb=function(e,t,n){this.target=e,this.za=t,this.Qb=n,this.sb=!1,d.s(this,"dispose",this.F)},d.Fb.prototype.F=function(){this.sb=!0,this.Qb()},d.N=function(){d.a.sa(this,d.N.fn),this.H={}};var f="change";a={V:function(e,t,n){var r=this;n=n||f;var i=new d.Fb(r,t?e.bind(t):e,function(){d.a.ma(r.H[n],i)});return r.o&&r.o(),r.H[n]||(r.H[n]=[]),r.H[n].push(i),i},notifySubscribers:function(e,t){if(t=t||f,this.qb(t))try{d.k.jb();for(var n,r=this.H[t].slice(0),i=0;n=r[i];++i)n.sb||n.za(e)}finally{d.k.end()}},Ma:function(e){var t,n,r,i=this,o=d.v(i);i.ia||(i.ia=i.notifySubscribers,i.notifySubscribers=function(e,t){t&&t!==f?"beforeChange"===t?i.bb(e):i.ia(e,t):i.cb(e)});var a=e(function(){o&&r===i&&(r=i()),t=!1,i.Ka(n,r)&&i.ia(n=r)});i.cb=function(e){t=!0,r=e,a()},i.bb=function(e){t||(n=e,i.ia(e,"beforeChange"))}},qb:function(e){return this.H[e]&&this.H[e].length},Wb:function(){var e=0;return d.a.A(this.H,function(t,n){e+=n.length}),e},Ka:function(e,t){return!this.equalityComparer||!this.equalityComparer(e,t)},extend:function(e){var t=this;return e&&d.a.A(e,function(e,n){var r=d.Ga[e];"function"==typeof r&&(t=r(t,n)||t)}),t}},d.s(a,"subscribe",a.V),d.s(a,"extend",a.extend),d.s(a,"getSubscriptionsCount",a.Wb),d.a.na&&d.a.ra(a,Function.prototype),d.N.fn=a,d.tb=function(e){return null!=e&&"function"==typeof e.V&&"function"==typeof e.notifySubscribers},d.b("subscribable",d.N),d.b("isSubscribable",d.tb),d.ca=d.k=function(){function e(e){r.push(n),n=e}function t(){n=r.pop()}var n,r=[],i=0;return{jb:e,end:t,zb:function(e){if(n){if(!d.tb(e))throw Error("Only subscribable things can act as dependencies");n.za(e,e.Kb||(e.Kb=++i))}},t:function(n,r,i){try{return e(),n.apply(r,i||[])}finally{t()}},fa:function(){return n?n.ba.fa():void 0},pa:function(){return n?n.pa:void 0}}}(),d.b("computedContext",d.ca),d.b("computedContext.getDependenciesCount",d.ca.fa),d.b("computedContext.isInitial",d.ca.pa),d.m=function(e){function t(){return 0<arguments.length?(t.Ka(n,arguments[0])&&(t.P(),n=arguments[0],t.O()),this):(d.k.zb(t),n)}var n=e;return d.N.call(t),d.a.sa(t,d.m.fn),t.o=function(){return n},t.O=function(){t.notifySubscribers(n)},t.P=function(){t.notifySubscribers(n,"beforeChange")},d.s(t,"peek",t.o),d.s(t,"valueHasMutated",t.O),d.s(t,"valueWillMutate",t.P),t},d.m.fn={equalityComparer:s};var p=d.m.hc="__ko_proto__";d.m.fn[p]=d.m,d.a.na&&d.a.ra(d.m.fn,d.N.fn),d.Ha=function(t,n){return null===t||t===e||t[p]===e?!1:t[p]===n?!0:d.Ha(t[p],n)},d.v=function(e){return d.Ha(e,d.m)},d.ub=function(e){return"function"==typeof e&&e[p]===d.m||"function"==typeof e&&e[p]===d.h&&e.Yb?!0:!1},d.b("observable",d.m),d.b("isObservable",d.v),d.b("isWriteableObservable",d.ub),d.T=function(e){if(e=e||[],"object"!=typeof e||!("length"in e))throw Error("The argument passed when initializing an observable array must be an array, or null, or undefined.");return e=d.m(e),d.a.sa(e,d.T.fn),e.extend({trackArrayChanges:!0})},d.T.fn={remove:function(e){for(var t=this.o(),n=[],r="function"!=typeof e||d.v(e)?function(t){return t===e}:e,i=0;i<t.length;i++){var o=t[i];r(o)&&(0===n.length&&this.P(),n.push(o),t.splice(i,1),i--)}return n.length&&this.O(),n},removeAll:function(t){if(t===e){var n=this.o(),r=n.slice(0);return this.P(),n.splice(0,n.length),this.O(),r}return t?this.remove(function(e){return 0<=d.a.l(t,e)}):[]},destroy:function(e){var t=this.o(),n="function"!=typeof e||d.v(e)?function(t){return t===e}:e;this.P();for(var r=t.length-1;r>=0;r--)n(t[r])&&(t[r]._destroy=!0);this.O()},destroyAll:function(t){return t===e?this.destroy(function(){return!0}):t?this.destroy(function(e){return 0<=d.a.l(t,e)}):[]},indexOf:function(e){var t=this();return d.a.l(t,e)},replace:function(e,t){var n=this.indexOf(e);n>=0&&(this.P(),this.o()[n]=t,this.O())}},d.a.r("pop push reverse shift sort splice unshift".split(" "),function(e){d.T.fn[e]=function(){var t=this.o();return this.P(),this.kb(t,e,arguments),t=t[e].apply(t,arguments),this.O(),t}}),d.a.r(["slice"],function(e){d.T.fn[e]=function(){var t=this();return t[e].apply(t,arguments)}}),d.a.na&&d.a.ra(d.T.fn,d.m.fn),d.b("observableArray",d.T);var m="arrayChange";d.Ga.trackArrayChanges=function(e){function t(){if(!n){n=!0;var t=e.notifySubscribers;e.notifySubscribers=function(e,n){return n&&n!==f||++i,t.apply(this,arguments)};var o=[].concat(e.o()||[]);r=null,e.V(function(t){if(t=[].concat(t||[]),e.qb(m)){var n;(!r||i>1)&&(r=d.a.Aa(o,t,{sparse:!0})),n=r,n.length&&e.notifySubscribers(n,m)}o=t,r=null,i=0})}}if(!e.kb){var n=!1,r=null,i=0,o=e.V;e.V=e.subscribe=function(e,n,r){return r===m&&t(),o.apply(this,arguments)},e.kb=function(e,t,o){function a(e,t,n){return s[s.length]={status:e,value:t,index:n}}if(n&&!i){var s=[],u=e.length,c=o.length,l=0;switch(t){case"push":l=u;case"unshift":for(t=0;c>t;t++)a("added",o[t],l+t);break;case"pop":l=u-1;case"shift":u&&a("deleted",e[l],l);break;case"splice":t=Math.min(Math.max(0,0>o[0]?u+o[0]:o[0]),u);for(var u=1===c?u:Math.min(t+(o[1]||0),u),c=t+c-2,l=Math.max(u,c),h=[],f=[],p=2;l>t;++t,++p)u>t&&f.push(a("deleted",e[t],t)),c>t&&h.push(a("added",o[p],t));d.a.nb(f,h);break;default:return}r=s}}}},d.ba=d.h=function(e,t,n){function r(){f=!0,d.a.A(w,function(e,t){t.F()}),w={},k=0,c=!1}function i(){var e=a.throttleEvaluation;e&&e>=0?(clearTimeout(P),P=setTimeout(o,e)):a.wa?a.wa():o()}function o(){if(!l&&!f){if(b&&b()){if(!h)return void y()}else h=!1;l=!0;try{var e=w,n=k;d.k.jb({za:function(t,r){f||(n&&e[r]?(w[r]=e[r],++k,delete e[r],--n):w[r]||(w[r]=t.V(i),++k))},ba:a,pa:!k}),w={},k=0;try{var r=t?p.call(t):p()}finally{d.k.end(),n&&d.a.A(e,function(e,t){t.F()}),c=!1}a.Ka(u,r)&&(a.notifySubscribers(u,"beforeChange"),u=r,a.wa&&!a.throttleEvaluation||a.notifySubscribers(u))}finally{l=!1}k||y()}}function a(){if(0<arguments.length){if("function"!=typeof m)throw Error("Cannot write a value to a ko.computed unless you specify a 'write' option. If you wish to read the current value, don't pass any parameters.");return m.apply(t,arguments),this}return c&&o(),d.k.zb(a),u}function s(){return c||k>0}var u,c=!0,l=!1,h=!1,f=!1,p=e;if(p&&"object"==typeof p?(n=p,p=n.read):(n=n||{},p||(p=n.read)),"function"!=typeof p)throw Error("Pass a function that returns the value of the ko.computed");var m=n.write,v=n.disposeWhenNodeIsRemoved||n.G||null,g=n.disposeWhen||n.Da,b=g,y=r,w={},k=0,P=null;t||(t=n.owner),d.N.call(a),d.a.sa(a,d.h.fn),a.o=function(){return c&&!k&&o(),u},a.fa=function(){return k},a.Yb="function"==typeof n.write,a.F=function(){y()},a.ga=s;var S=a.Ma;return a.Ma=function(e){S.call(a,e),a.wa=function(){a.bb(u),c=!0,a.cb(a)}},d.s(a,"peek",a.o),d.s(a,"dispose",a.F),d.s(a,"isActive",a.ga),d.s(a,"getDependenciesCount",a.fa),v&&(h=!0,v.nodeType&&(b=function(){return!d.a.Ea(v)||g&&g()})),!0!==n.deferEvaluation&&o(),v&&s()&&v.nodeType&&(y=function(){d.a.u.Ab(v,y),r()},d.a.u.ja(v,y)),a},d.$b=function(e){return d.Ha(e,d.h)},a=d.m.hc,d.h[a]=d.m,d.h.fn={equalityComparer:s},d.h.fn[a]=d.h,d.a.na&&d.a.ra(d.h.fn,d.N.fn),d.b("dependentObservable",d.h),d.b("computed",d.h),d.b("isComputed",d.$b),function(){function t(i,o,a){if(a=a||new r,i=o(i),"object"!=typeof i||null===i||i===e||i instanceof Date||i instanceof String||i instanceof Number||i instanceof Boolean)return i;var s=i instanceof Array?[]:{};return a.save(i,s),n(i,function(n){var r=o(i[n]);switch(typeof r){case"boolean":case"number":case"string":case"function":s[n]=r;break;case"object":case"undefined":var u=a.get(r);s[n]=u!==e?u:t(r,o,a)}}),s}function n(e,t){if(e instanceof Array){for(var n=0;n<e.length;n++)t(n);"function"==typeof e.toJSON&&t("toJSON")}else for(n in e)t(n)}function r(){this.keys=[],this.ab=[]}d.Gb=function(e){if(0==arguments.length)throw Error("When calling ko.toJS, pass the object you want to convert.");return t(e,function(e){for(var t=0;d.v(e)&&10>t;t++)e=e();return e})},d.toJSON=function(e,t,n){return e=d.Gb(e),d.a.Ya(e,t,n)},r.prototype={save:function(e,t){var n=d.a.l(this.keys,e);n>=0?this.ab[n]=t:(this.keys.push(e),this.ab.push(t))},get:function(t){return t=d.a.l(this.keys,t),t>=0?this.ab[t]:e}}}(),d.b("toJS",d.Gb),d.b("toJSON",d.toJSON),function(){d.i={p:function(t){switch(d.a.B(t)){case"option":return!0===t.__ko__hasDomDataOptionValue__?d.a.f.get(t,d.d.options.Pa):7>=d.a.oa?t.getAttributeNode("value")&&t.getAttributeNode("value").specified?t.value:t.text:t.value;case"select":return 0<=t.selectedIndex?d.i.p(t.options[t.selectedIndex]):e;default:return t.value}},X:function(t,n,r){switch(d.a.B(t)){case"option":switch(typeof n){case"string":d.a.f.set(t,d.d.options.Pa,e),"__ko__hasDomDataOptionValue__"in t&&delete t.__ko__hasDomDataOptionValue__,t.value=n;break;default:d.a.f.set(t,d.d.options.Pa,n),t.__ko__hasDomDataOptionValue__=!0,t.value="number"==typeof n?n:""}break;case"select":(""===n||null===n)&&(n=e);for(var i,o=-1,a=0,s=t.options.length;s>a;++a)if(i=d.i.p(t.options[a]),i==n||""==i&&n===e){o=a;break}(r||o>=0||n===e&&1<t.size)&&(t.selectedIndex=o);break;default:(null===n||n===e)&&(n=""),t.value=n}}}}(),d.b("selectExtensions",d.i),d.b("selectExtensions.readValue",d.i.p),d.b("selectExtensions.writeValue",d.i.X),d.g=function(){function e(e){e=d.a.ta(e),123===e.charCodeAt(0)&&(e=e.slice(1,-1));var t,n,a=[],s=e.match(r),u=0;if(s){s.push(",");for(var c,l=0;c=s[l];++l){var h=c.charCodeAt(0);if(44===h){if(0>=u){t&&a.push(n?{key:t,value:n.join("")}:{unknown:t}),t=n=u=0;continue}}else if(58===h){if(!n)continue}else if(47===h&&l&&1<c.length)(h=s[l-1].match(i))&&!o[h[0]]&&(e=e.substr(e.indexOf(c)+1),s=e.match(r),s.push(","),l=-1,c="/");else if(40===h||123===h||91===h)++u;else if(41===h||125===h||93===h)--u;else if(!t&&!n){t=34===h||39===h?c.slice(1,-1):c;continue}n?n.push(c):n=[c]}}return a}var t=["true","false","null","undefined"],n=/^(?:[$_a-z][$\w]*|(.+)(\.\s*[$_a-z][$\w]*|\[.+\]))$/i,r=RegExp("\"(?:[^\"\\\\]|\\\\.)*\"|'(?:[^'\\\\]|\\\\.)*'|/(?:[^/\\\\]|\\\\.)*/w*|[^\\s:,/][^,\"'{}()/:[\\]]*[^\\s,\"'{}()/:[\\]]|[^\\s]","g"),i=/[\])"'A-Za-z0-9_$]+$/,o={"in":1,"return":1,"typeof":1},a={};return{aa:[],W:a,Ra:e,qa:function(r,i){function o(e,r){var i,l=d.getBindingHandler(e);(l&&l.preprocess?r=l.preprocess(r,e,o):1)&&((l=a[e])&&(i=r,0<=d.a.l(t,i)?i=!1:(l=i.match(n),i=null===l?!1:l[1]?"Object("+l[1]+")"+l[2]:i),l=i),l&&u.push("'"+e+"':function(_z){"+i+"=_z}"),c&&(r="function(){return "+r+" }"),s.push("'"+e+"':"+r))}i=i||{};var s=[],u=[],c=i.valueAccessors,l="string"==typeof r?e(r):r;return d.a.r(l,function(e){o(e.key||e.unknown,e.value)}),u.length&&o("_ko_property_writers","{"+u.join(",")+" }"),s.join(",")},bc:function(e,t){for(var n=0;n<e.length;n++)if(e[n].key==t)return!0;return!1},va:function(e,t,n,r,i){e&&d.v(e)?!d.ub(e)||i&&e.o()===r||e(r):(e=t.get("_ko_property_writers"))&&e[n]&&e[n](r)}}}(),d.b("expressionRewriting",d.g),d.b("expressionRewriting.bindingRewriteValidators",d.g.aa),d.b("expressionRewriting.parseObjectLiteral",d.g.Ra),d.b("expressionRewriting.preProcessBindings",d.g.qa),d.b("expressionRewriting._twoWayBindings",d.g.W),d.b("jsonExpressionRewriting",d.g),d.b("jsonExpressionRewriting.insertPropertyAccessorsIntoJson",d.g.qa),function(){function e(e){return 8==e.nodeType&&a.test(o?e.text:e.nodeValue)}function t(e){return 8==e.nodeType&&s.test(o?e.text:e.nodeValue)}function r(n,r){for(var i=n,o=1,a=[];i=i.nextSibling;){if(t(i)&&(o--,0===o))return a;a.push(i),e(i)&&o++}if(!r)throw Error("Cannot find closing comment tag to match: "+n.nodeValue);return null}function i(e,t){var n=r(e,t);return n?0<n.length?n[n.length-1].nextSibling:e.nextSibling:null}var o=n&&"<!--test-->"===n.createComment("test").text,a=o?/^\x3c!--\s*ko(?:\s+([\s\S]+))?\s*--\x3e$/:/^\s*ko(?:\s+([\s\S]+))?\s*$/,s=o?/^\x3c!--\s*\/ko\s*--\x3e$/:/^\s*\/ko\s*$/,u={ul:!0,ol:!0};d.e={Q:{},childNodes:function(t){return e(t)?r(t):t.childNodes},da:function(t){if(e(t)){t=d.e.childNodes(t);for(var n=0,r=t.length;r>n;n++)d.removeNode(t[n])}else d.a.Fa(t)},U:function(t,n){if(e(t)){d.e.da(t);for(var r=t.nextSibling,i=0,o=n.length;o>i;i++)r.parentNode.insertBefore(n[i],r)}else d.a.U(t,n)},yb:function(t,n){e(t)?t.parentNode.insertBefore(n,t.nextSibling):t.firstChild?t.insertBefore(n,t.firstChild):t.appendChild(n)},rb:function(t,n,r){r?e(t)?t.parentNode.insertBefore(n,r.nextSibling):r.nextSibling?t.insertBefore(n,r.nextSibling):t.appendChild(n):d.e.yb(t,n)},firstChild:function(n){return e(n)?!n.nextSibling||t(n.nextSibling)?null:n.nextSibling:n.firstChild},nextSibling:function(n){return e(n)&&(n=i(n)),n.nextSibling&&t(n.nextSibling)?null:n.nextSibling},Xb:e,lc:function(e){return(e=(o?e.text:e.nodeValue).match(a))?e[1]:null},wb:function(n){if(u[d.a.B(n)]){var r=n.firstChild;if(r)do if(1===r.nodeType){var o;o=r.firstChild;var a=null;if(o)do if(a)a.push(o);else if(e(o)){var s=i(o,!0);s?o=s:a=[o]}else t(o)&&(a=[o]);while(o=o.nextSibling);if(o=a)for(a=r.nextSibling,s=0;s<o.length;s++)a?n.insertBefore(o[s],a):n.appendChild(o[s])}while(r=r.nextSibling)}}}}(),d.b("virtualElements",d.e),d.b("virtualElements.allowedBindings",d.e.Q),d.b("virtualElements.emptyNode",d.e.da),d.b("virtualElements.insertAfter",d.e.rb),d.b("virtualElements.prepend",d.e.yb),d.b("virtualElements.setDomNodeChildren",d.e.U),function(){d.J=function(){this.Nb={}},d.a.extend(d.J.prototype,{nodeHasBindings:function(e){switch(e.nodeType){case 1:return null!=e.getAttribute("data-bind");case 8:return d.e.Xb(e);default:return!1}},getBindings:function(e,t){var n=this.getBindingsString(e,t);return n?this.parseBindingsString(n,t,e):null},getBindingAccessors:function(e,t){var n=this.getBindingsString(e,t);return n?this.parseBindingsString(n,t,e,{valueAccessors:!0}):null},getBindingsString:function(e){switch(e.nodeType){case 1:return e.getAttribute("data-bind");case 8:return d.e.lc(e);default:return null}},parseBindingsString:function(e,t,n,r){try{var i,o=this.Nb,a=e+(r&&r.valueAccessors||"");if(!(i=o[a])){var s,u="with($context){with($data||{}){return{"+d.g.qa(e,r)+"}}}";s=new Function("$context","$element",u),i=o[a]=s}return i(t,n)}catch(c){throw c.message="Unable to parse bindings.\nBindings value: "+e+"\nMessage: "+c.message,c}}}),d.J.instance=new d.J}(),d.b("bindingProvider",d.J),function(){function n(e){return function(){return e}}function r(e){return e()}function o(e){return d.a.Oa(d.k.t(e),function(t,n){return function(){return e()[n]}})}function a(e,t){return o(this.getBindings.bind(this,e,t))}function s(e,t,n){var r,i=d.e.firstChild(t),o=d.J.instance,a=o.preprocessNode;if(a){for(;r=i;)i=d.e.nextSibling(r),a.call(o,r);i=d.e.firstChild(t)}for(;r=i;)i=d.e.nextSibling(r),u(e,r,n)}function u(e,t,n){var r=!0,i=1===t.nodeType;i&&d.e.wb(t),(i&&n||d.J.instance.nodeHasBindings(t))&&(r=l(t,null,e,n).shouldBindDescendants),r&&!f[d.a.B(t)]&&s(e,t,!i)}function c(e){var t=[],n={},r=[];return d.a.A(e,function i(o){if(!n[o]){var a=d.getBindingHandler(o);a&&(a.after&&(r.push(o),d.a.r(a.after,function(t){if(e[t]){if(-1!==d.a.l(r,t))throw Error("Cannot combine the following bindings, because they have a cyclic dependency: "+r.join(", "));i(t)}}),r.length--),t.push({key:o,pb:a})),n[o]=!0}}),t}function l(t,n,i,o){var s=d.a.f.get(t,p);if(!n){if(s)throw Error("You cannot apply bindings multiple times to the same element.");d.a.f.set(t,p,!0)}!s&&o&&d.Eb(t,i);var u;if(n&&"function"!=typeof n)u=n;else{var l=d.J.instance,h=l.getBindingAccessors||a,f=d.h(function(){return(u=n?n(i,t):h.call(l,t,i))&&i.D&&i.D(),u},null,{G:t});u&&f.ga()||(f=null)}var m;if(u){var v=f?function(e){return function(){return r(f()[e])}}:function(e){return u[e]},g=function(){return d.a.Oa(f?f():u,r)};g.get=function(e){return u[e]&&r(v(e))},g.has=function(e){return e in u},o=c(u),d.a.r(o,function(n){var r=n.pb.init,o=n.pb.update,a=n.key;if(8===t.nodeType&&!d.e.Q[a])throw Error("The binding '"+a+"' cannot be used with virtual elements");try{"function"==typeof r&&d.k.t(function(){var n=r(t,v(a),g,i.$data,i);if(n&&n.controlsDescendantBindings){if(m!==e)throw Error("Multiple bindings ("+m+" and "+a+") are trying to control descendant bindings of the same element. You cannot use these bindings together on the same element.");m=a}}),"function"==typeof o&&d.h(function(){o(t,v(a),g,i.$data,i)},null,{G:t})}catch(s){throw s.message='Unable to process binding "'+a+": "+u[a]+'"\nMessage: '+s.message,s}})}return{shouldBindDescendants:m===e}}function h(e){return e&&e instanceof d.I?e:new d.I(e)}d.d={};var f={script:!0};d.getBindingHandler=function(e){return d.d[e]},d.I=function(t,n,r,i){var o,a=this,s="function"==typeof t&&!d.v(t),u=d.h(function(){var e=s?t():t,o=d.a.c(e);return n?(n.D&&n.D(),d.a.extend(a,n),u&&(a.D=u)):(a.$parents=[],a.$root=o,a.ko=d),a.$rawData=e,a.$data=o,r&&(a[r]=o),i&&i(a,n,o),a.$data},null,{Da:function(){return o&&!d.a.eb(o)},G:!0});u.ga()&&(a.D=u,u.equalityComparer=null,o=[],u.Jb=function(t){o.push(t),d.a.u.ja(t,function(t){d.a.ma(o,t),o.length||(u.F(),a.D=u=e)})})},d.I.prototype.createChildContext=function(e,t,n){return new d.I(e,this,t,function(e,t){e.$parentContext=t,e.$parent=t.$data,e.$parents=(t.$parents||[]).slice(0),e.$parents.unshift(e.$parent),n&&n(e)})},d.I.prototype.extend=function(e){return new d.I(this.D||this.$data,this,null,function(t,n){t.$rawData=n.$rawData,d.a.extend(t,"function"==typeof e?e():e)})};var p=d.a.f.L(),m=d.a.f.L();d.Eb=function(e,t){return 2!=arguments.length?d.a.f.get(e,m):(d.a.f.set(e,m,t),void(t.D&&t.D.Jb(e)))},d.xa=function(e,t,n){return 1===e.nodeType&&d.e.wb(e),l(e,t,h(n),!0)},d.Lb=function(e,t,r){return r=h(r),d.xa(e,"function"==typeof t?o(t.bind(null,r,e)):d.a.Oa(t,n),r)},d.gb=function(e,t){1!==t.nodeType&&8!==t.nodeType||s(h(e),t,!0)},d.fb=function(e,n){if(!i&&t.jQuery&&(i=t.jQuery),n&&1!==n.nodeType&&8!==n.nodeType)throw Error("ko.applyBindings: first parameter should be your view model; second parameter should be a DOM node");n=n||t.document.body,u(h(e),n,!0)},d.Ca=function(t){switch(t.nodeType){case 1:case 8:var n=d.Eb(t);if(n)return n;if(t.parentNode)return d.Ca(t.parentNode)}return e},d.Pb=function(t){return(t=d.Ca(t))?t.$data:e},d.b("bindingHandlers",d.d),d.b("applyBindings",d.fb),d.b("applyBindingsToDescendants",d.gb),d.b("applyBindingAccessorsToNode",d.xa),d.b("applyBindingsToNode",d.Lb),d.b("contextFor",d.Ca),d.b("dataFor",d.Pb)}();var v={"class":"className","for":"htmlFor"};d.d.attr={update:function(t,n){var r=d.a.c(n())||{};d.a.A(r,function(n,r){r=d.a.c(r);var i=!1===r||null===r||r===e;i&&t.removeAttribute(n),8>=d.a.oa&&n in v?(n=v[n],i?t.removeAttribute(n):t[n]=r):i||t.setAttribute(n,r.toString()),"name"===n&&d.a.Cb(t,i?"":r.toString())})}},function(){d.d.checked={after:["value","attr"],init:function(t,n,r){function i(){return r.has("checkedValue")?d.a.c(r.get("checkedValue")):t.value}function o(){var e=t.checked,o=h?i():e;if(!d.ca.pa()&&(!u||e)){var a=d.k.t(n);c?l!==o?(e&&(d.a.Y(a,o,!0),d.a.Y(a,l,!1)),l=o):d.a.Y(a,o,e):d.g.va(a,r,"checked",o,!0)}}function a(){var e=d.a.c(n());t.checked=c?0<=d.a.l(e,i()):s?e:i()===e}var s="checkbox"==t.type,u="radio"==t.type;if(s||u){var c=s&&d.a.c(n())instanceof Array,l=c?i():e,h=u||c;u&&!t.name&&d.d.uniqueName.init(t,function(){return!0}),d.ba(o,null,{G:t}),d.a.q(t,"click",o),d.ba(a,null,{G:t})}}},d.g.W.checked=!0,d.d.checkedValue={update:function(e,t){e.value=d.a.c(t())}}}(),d.d.css={update:function(e,t){var n=d.a.c(t());"object"==typeof n?d.a.A(n,function(t,n){n=d.a.c(n),d.a.ua(e,t,n)}):(n=String(n||""),d.a.ua(e,e.__ko__cssValue,!1),e.__ko__cssValue=n,d.a.ua(e,n,!0))}},d.d.enable={update:function(e,t){var n=d.a.c(t());n&&e.disabled?e.removeAttribute("disabled"):n||e.disabled||(e.disabled=!0)}},d.d.disable={update:function(e,t){d.d.enable.update(e,function(){return!d.a.c(t())})}},d.d.event={init:function(e,t,n,r,i){var o=t()||{};d.a.A(o,function(o){"string"==typeof o&&d.a.q(e,o,function(e){var a,s=t()[o];if(s){try{var u=d.a.R(arguments);r=i.$data,u.unshift(r),a=s.apply(r,u)}finally{!0!==a&&(e.preventDefault?e.preventDefault():e.returnValue=!1)}!1===n.get(o+"Bubble")&&(e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation())}})})}},d.d.foreach={vb:function(e){return function(){var t=e(),n=d.a.Sa(t);return n&&"number"!=typeof n.length?(d.a.c(t),{foreach:n.data,as:n.as,includeDestroyed:n.includeDestroyed,afterAdd:n.afterAdd,beforeRemove:n.beforeRemove,afterRender:n.afterRender,beforeMove:n.beforeMove,afterMove:n.afterMove,templateEngine:d.K.Ja}):{foreach:t,templateEngine:d.K.Ja}}},init:function(e,t){return d.d.template.init(e,d.d.foreach.vb(t))},update:function(e,t,n,r,i){return d.d.template.update(e,d.d.foreach.vb(t),n,r,i)}},d.g.aa.foreach=!1,d.e.Q.foreach=!0,d.d.hasfocus={init:function(e,t,n){function r(r){e.__ko_hasfocusUpdating=!0;var i=e.ownerDocument;if("activeElement"in i){var o;try{o=i.activeElement}catch(a){o=i.body}r=o===e}i=t(),d.g.va(i,n,"hasfocus",r,!0),e.__ko_hasfocusLastValue=r,e.__ko_hasfocusUpdating=!1}var i=r.bind(null,!0),o=r.bind(null,!1);d.a.q(e,"focus",i),d.a.q(e,"focusin",i),d.a.q(e,"blur",o),d.a.q(e,"focusout",o)},update:function(e,t){var n=!!d.a.c(t());e.__ko_hasfocusUpdating||e.__ko_hasfocusLastValue===n||(n?e.focus():e.blur(),d.k.t(d.a.ha,null,[e,n?"focusin":"focusout"]))}},d.g.W.hasfocus=!0,d.d.hasFocus=d.d.hasfocus,d.g.W.hasFocus=!0,d.d.html={init:function(){return{controlsDescendantBindings:!0}},update:function(e,t){d.a.Va(e,t())}},l("if"),l("ifnot",!1,!0),l("with",!0,!1,function(e,t){return e.createChildContext(t)});var g={};d.d.options={init:function(e){if("select"!==d.a.B(e))throw Error("options binding applies only to SELECT elements");for(;0<e.length;)e.remove(0);return{controlsDescendantBindings:!0}},update:function(t,n,r){function i(){return d.a.la(t.options,function(e){return e.selected})}function o(e,t,n){var r=typeof t;return"function"==r?t(e):"string"==r?e[t]:n}function a(e,n){if(h.length){var r=0<=d.a.l(h,d.i.p(n[0]));d.a.Db(n[0],r),f&&!r&&d.k.t(d.a.ha,null,[t,"change"])}}var s=0!=t.length&&t.multiple?t.scrollTop:null,u=d.a.c(n()),c=r.get("optionsIncludeDestroyed");n={};var l,h;h=t.multiple?d.a.ya(i(),d.i.p):0<=t.selectedIndex?[d.i.p(t.options[t.selectedIndex])]:[],u&&("undefined"==typeof u.length&&(u=[u]),l=d.a.la(u,function(t){return c||t===e||null===t||!d.a.c(t._destroy)}),r.has("optionsCaption")&&(u=d.a.c(r.get("optionsCaption")),null!==u&&u!==e&&l.unshift(g)));var f=!1;n.beforeRemove=function(e){t.removeChild(e)},u=a,r.has("optionsAfterRender")&&(u=function(t,n){a(0,n),d.k.t(r.get("optionsAfterRender"),null,[n[0],t!==g?t:e])}),d.a.Ua(t,l,function(n,i,a){return a.length&&(h=a[0].selected?[d.i.p(a[0])]:[],f=!0),i=t.ownerDocument.createElement("option"),n===g?(d.a.Xa(i,r.get("optionsCaption")),d.i.X(i,e)):(a=o(n,r.get("optionsValue"),n),d.i.X(i,d.a.c(a)),n=o(n,r.get("optionsText"),a),d.a.Xa(i,n)),[i]},n,u),d.k.t(function(){r.get("valueAllowUnset")&&r.has("value")?d.i.X(t,d.a.c(r.get("value")),!0):(t.multiple?h.length&&i().length<h.length:h.length&&0<=t.selectedIndex?d.i.p(t.options[t.selectedIndex])!==h[0]:h.length||0<=t.selectedIndex)&&d.a.ha(t,"change")}),d.a.Tb(t),s&&20<Math.abs(s-t.scrollTop)&&(t.scrollTop=s)}},d.d.options.Pa=d.a.f.L(),d.d.selectedOptions={after:["options","foreach"],init:function(e,t,n){d.a.q(e,"change",function(){var r=t(),i=[];d.a.r(e.getElementsByTagName("option"),function(e){e.selected&&i.push(d.i.p(e))}),d.g.va(r,n,"selectedOptions",i)})},update:function(e,t){if("select"!=d.a.B(e))throw Error("values binding applies only to SELECT elements");var n=d.a.c(t());n&&"number"==typeof n.length&&d.a.r(e.getElementsByTagName("option"),function(e){var t=0<=d.a.l(n,d.i.p(e));d.a.Db(e,t)})}},d.g.W.selectedOptions=!0,d.d.style={update:function(e,t){var n=d.a.c(t()||{});d.a.A(n,function(t,n){n=d.a.c(n),e.style[t]=n||""})}},d.d.submit={init:function(e,t,n,r,i){if("function"!=typeof t())throw Error("The value for a submit binding must be a function");d.a.q(e,"submit",function(n){var r,o=t();try{r=o.call(i.$data,e)}finally{!0!==r&&(n.preventDefault?n.preventDefault():n.returnValue=!1)}})}},d.d.text={init:function(){return{controlsDescendantBindings:!0}},update:function(e,t){d.a.Xa(e,t())}},d.e.Q.text=!0,d.d.uniqueName={init:function(e,t){if(t()){var n="ko_unique_"+ ++d.d.uniqueName.Ob;d.a.Cb(e,n)}}},d.d.uniqueName.Ob=0,d.d.value={after:["options","foreach"],init:function(e,t,n){function r(){a=!1;var r=t(),i=d.i.p(e);d.g.va(r,n,"value",i)}var i=["change"],o=n.get("valueUpdate"),a=!1;o&&("string"==typeof o&&(o=[o]),d.a.$(i,o),i=d.a.ib(i)),!d.a.oa||"input"!=e.tagName.toLowerCase()||"text"!=e.type||"off"==e.autocomplete||e.form&&"off"==e.form.autocomplete||-1!=d.a.l(i,"propertychange")||(d.a.q(e,"propertychange",function(){a=!0}),d.a.q(e,"focus",function(){a=!1}),d.a.q(e,"blur",function(){a&&r()})),d.a.r(i,function(t){var n=r;d.a.kc(t,"after")&&(n=function(){setTimeout(r,0)},t=t.substring(5)),d.a.q(e,t,n)})},update:function(e,t,n){var r=d.a.c(t());if(t=d.i.p(e),r!==t)if("select"===d.a.B(e)){var i=n.get("valueAllowUnset");n=function(){d.i.X(e,r,i)},n(),i||r===d.i.p(e)?setTimeout(n,0):d.k.t(d.a.ha,null,[e,"change"])}else d.i.X(e,r)}},d.g.W.value=!0,d.d.visible={update:function(e,t){var n=d.a.c(t()),r="none"!=e.style.display;n&&!r?e.style.display="":!n&&r&&(e.style.display="none")}},function(e){d.d[e]={init:function(t,n,r,i,o){return d.d.event.init.call(this,t,function(){var t={};return t[e]=n(),t},r,i,o)}}}("click"),d.C=function(){},d.C.prototype.renderTemplateSource=function(){throw Error("Override renderTemplateSource")},d.C.prototype.createJavaScriptEvaluatorBlock=function(){throw Error("Override createJavaScriptEvaluatorBlock")},d.C.prototype.makeTemplateSource=function(e,t){if("string"==typeof e){t=t||n;var r=t.getElementById(e);if(!r)throw Error("Cannot find template with ID "+e);return new d.n.j(r)}if(1==e.nodeType||8==e.nodeType)return new d.n.Z(e);throw Error("Unknown template type: "+e)},d.C.prototype.renderTemplate=function(e,t,n,r){return e=this.makeTemplateSource(e,r),this.renderTemplateSource(e,t,n)},d.C.prototype.isTemplateRewritten=function(e,t){return!1===this.allowTemplateRewriting?!0:this.makeTemplateSource(e,t).data("isRewritten")},d.C.prototype.rewriteTemplate=function(e,t,n){e=this.makeTemplateSource(e,n),t=t(e.text()),e.text(t),e.data("isRewritten",!0)},d.b("templateEngine",d.C),d.Za=function(){function e(e,t,n,r){e=d.g.Ra(e);for(var i=d.g.aa,o=0;o<e.length;o++){var a=e[o].key;if(i.hasOwnProperty(a)){var s=i[a];if("function"==typeof s){if(a=s(e[o].value))throw Error(a)}else if(!s)throw Error("This template engine does not support the '"+a+"' binding within its templates")}}return n="ko.__tr_ambtns(function($context,$element){return(function(){return{ "+d.g.qa(e,{valueAccessors:!0})+" } })()},'"+n.toLowerCase()+"')",r.createJavaScriptEvaluatorBlock(n)+t}var t=/(<([a-z]+\d*)(?:\s+(?!data-bind\s*=\s*)[a-z0-9\-]+(?:=(?:\"[^\"]*\"|\'[^\']*\'))?)*\s+)data-bind\s*=\s*(["'])([\s\S]*?)\3/gi,n=/\x3c!--\s*ko\b\s*([\s\S]*?)\s*--\x3e/g;return{Ub:function(e,t,n){t.isTemplateRewritten(e,n)||t.rewriteTemplate(e,function(e){return d.Za.dc(e,t)},n)},dc:function(r,i){return r.replace(t,function(t,n,r,o,a){return e(a,n,r,i)}).replace(n,function(t,n){return e(n,"<!-- ko -->","#comment",i)})},Mb:function(e,t){return d.w.Na(function(n,r){var i=n.nextSibling;i&&i.nodeName.toLowerCase()===t&&d.xa(i,e,r)})}}}(),d.b("__tr_ambtns",d.Za.Mb),function(){d.n={},d.n.j=function(e){this.j=e},d.n.j.prototype.text=function(){var e=d.a.B(this.j),e="script"===e?"text":"textarea"===e?"value":"innerHTML";if(0==arguments.length)return this.j[e];var t=arguments[0];"innerHTML"===e?d.a.Va(this.j,t):this.j[e]=t};var t=d.a.f.L()+"_";d.n.j.prototype.data=function(e){return 1===arguments.length?d.a.f.get(this.j,t+e):void d.a.f.set(this.j,t+e,arguments[1])};var n=d.a.f.L();d.n.Z=function(e){this.j=e},d.n.Z.prototype=new d.n.j,d.n.Z.prototype.text=function(){if(0==arguments.length){var t=d.a.f.get(this.j,n)||{};return t.$a===e&&t.Ba&&(t.$a=t.Ba.innerHTML),t.$a}d.a.f.set(this.j,n,{$a:arguments[0]})},d.n.j.prototype.nodes=function(){return 0==arguments.length?(d.a.f.get(this.j,n)||{}).Ba:void d.a.f.set(this.j,n,{Ba:arguments[0]})},d.b("templateSources",d.n),d.b("templateSources.domElement",d.n.j),d.b("templateSources.anonymousTemplate",d.n.Z)}(),function(){function t(e,t,n){var r;for(t=d.e.nextSibling(t);e&&(r=e)!==t;)e=d.e.nextSibling(r),n(r,e)}function n(e,n){if(e.length){var r=e[0],i=e[e.length-1],o=r.parentNode,a=d.J.instance,s=a.preprocessNode;if(s){if(t(r,i,function(e,t){var n=e.previousSibling,o=s.call(a,e);o&&(e===r&&(r=o[0]||t),e===i&&(i=o[o.length-1]||n))}),e.length=0,!r)return;r===i?e.push(r):(e.push(r,i),d.a.ea(e,o))}t(r,i,function(e){1!==e.nodeType&&8!==e.nodeType||d.fb(n,e)
}),t(r,i,function(e){1!==e.nodeType&&8!==e.nodeType||d.w.Ib(e,[n])}),d.a.ea(e,o)}}function r(e){return e.nodeType?e:0<e.length?e[0]:null}function i(e,t,i,a,s){s=s||{};var u=e&&r(e),u=u&&u.ownerDocument,c=s.templateEngine||o;if(d.Za.Ub(i,c,u),i=c.renderTemplate(i,a,s,u),"number"!=typeof i.length||0<i.length&&"number"!=typeof i[0].nodeType)throw Error("Template engine must return an array of DOM nodes");switch(u=!1,t){case"replaceChildren":d.e.U(e,i),u=!0;break;case"replaceNode":d.a.Bb(e,i),u=!0;break;case"ignoreTargetNode":break;default:throw Error("Unknown renderMode: "+t)}return u&&(n(i,a),s.afterRender&&d.k.t(s.afterRender,null,[i,a.$data])),i}var o;d.Wa=function(t){if(t!=e&&!(t instanceof d.C))throw Error("templateEngine must inherit from ko.templateEngine");o=t},d.Ta=function(t,n,a,s,u){if(a=a||{},(a.templateEngine||o)==e)throw Error("Set a template engine before calling renderTemplate");if(u=u||"replaceChildren",s){var c=r(s);return d.h(function(){var e=n&&n instanceof d.I?n:new d.I(d.a.c(n)),o=d.v(t)?t():"function"==typeof t?t(e.$data,e):t,e=i(s,u,o,e,a);"replaceNode"==u&&(s=e,c=r(s))},null,{Da:function(){return!c||!d.a.Ea(c)},G:c&&"replaceNode"==u?c.parentNode:c})}return d.w.Na(function(e){d.Ta(t,n,a,e,"replaceNode")})},d.jc=function(t,r,o,a,s){function u(e,t){n(t,l),o.afterRender&&o.afterRender(t,e)}function c(e,n){l=s.createChildContext(e,o.as,function(e){e.$index=n});var r="function"==typeof t?t(e,l):t;return i(null,"ignoreTargetNode",r,l,o)}var l;return d.h(function(){var t=d.a.c(r)||[];"undefined"==typeof t.length&&(t=[t]),t=d.a.la(t,function(t){return o.includeDestroyed||t===e||null===t||!d.a.c(t._destroy)}),d.k.t(d.a.Ua,null,[a,t,c,o,u])},null,{G:a})};var a=d.a.f.L();d.d.template={init:function(e,t){var n=d.a.c(t());return"string"==typeof n||n.name?d.e.da(e):(n=d.e.childNodes(e),n=d.a.ec(n),new d.n.Z(e).nodes(n)),{controlsDescendantBindings:!0}},update:function(t,n,r,i,o){var s,u=n();n=d.a.c(u),r=!0,i=null,"string"==typeof n?n={}:(u=n.name,"if"in n&&(r=d.a.c(n["if"])),r&&"ifnot"in n&&(r=!d.a.c(n.ifnot)),s=d.a.c(n.data)),"foreach"in n?i=d.jc(u||t,r&&n.foreach||[],n,t,o):r?(o="data"in n?o.createChildContext(s,n.as):o,i=d.Ta(u||t,o,n,t)):d.e.da(t),o=i,(s=d.a.f.get(t,a))&&"function"==typeof s.F&&s.F(),d.a.f.set(t,a,o&&o.ga()?o:e)}},d.g.aa.template=function(e){return e=d.g.Ra(e),1==e.length&&e[0].unknown||d.g.bc(e,"name")?null:"This template engine does not support anonymous templates nested within its templates"},d.e.Q.template=!0}(),d.b("setTemplateEngine",d.Wa),d.b("renderTemplate",d.Ta),d.a.nb=function(e,t,n){if(e.length&&t.length){var r,i,o,a,s;for(r=i=0;(!n||n>r)&&(a=e[i]);++i){for(o=0;s=t[o];++o)if(a.value===s.value){a.moved=s.index,s.moved=a.index,t.splice(o,1),r=o=0;break}r+=o}}},d.a.Aa=function(){function e(e,t,n,r,i){var o,a,s,u,c,l=Math.min,h=Math.max,f=[],p=e.length,m=t.length,v=m-p||1,g=p+m+1;for(o=0;p>=o;o++)for(u=s,f.push(s=[]),c=l(m,o+v),a=h(0,o-1);c>=a;a++)s[a]=a?o?e[o-1]===t[a-1]?u[a-1]:l(u[a]||g,s[a-1]||g)+1:a+1:o+1;for(l=[],h=[],v=[],o=p,a=m;o||a;)m=f[o][a]-1,a&&m===f[o][a-1]?h.push(l[l.length]={status:n,value:t[--a],index:a}):o&&m===f[o-1][a]?v.push(l[l.length]={status:r,value:e[--o],index:o}):(--a,--o,i.sparse||l.push({status:"retained",value:t[a]}));return d.a.nb(h,v,10*p),l.reverse()}return function(t,n,r){return r="boolean"==typeof r?{dontLimitMoves:r}:r||{},t=t||[],n=n||[],t.length<=n.length?e(t,n,"added","deleted",r):e(n,t,"deleted","added",r)}}(),d.b("utils.compareArrays",d.a.Aa),function(){function t(t,n,r,i,o){var a=[],s=d.h(function(){var e=n(r,o,d.a.ea(a,t))||[];0<a.length&&(d.a.Bb(a,e),i&&d.k.t(i,null,[r,e,o])),a.length=0,d.a.$(a,e)},null,{G:t,Da:function(){return!d.a.eb(a)}});return{S:a,h:s.ga()?s:e}}var n=d.a.f.L();d.a.Ua=function(r,i,o,a,s){function u(e,t){w=h[t],g!==t&&(S[e]=w),w.Ia(g++),d.a.ea(w.S,r),m.push(w),y.push(w)}function c(e,t){if(e)for(var n=0,r=t.length;r>n;n++)t[n]&&d.a.r(t[n].S,function(r){e(r,n,t[n].ka)})}i=i||[],a=a||{};var l=d.a.f.get(r,n)===e,h=d.a.f.get(r,n)||[],f=d.a.ya(h,function(e){return e.ka}),p=d.a.Aa(f,i,a.dontLimitMoves),m=[],v=0,g=0,b=[],y=[];i=[];for(var w,k,P,S=[],f=[],C=0;k=p[C];C++)switch(P=k.moved,k.status){case"deleted":P===e&&(w=h[v],w.h&&w.h.F(),b.push.apply(b,d.a.ea(w.S,r)),a.beforeRemove&&(i[C]=w,y.push(w))),v++;break;case"retained":u(C,v++);break;case"added":P!==e?u(C,P):(w={ka:k.value,Ia:d.m(g++)},m.push(w),y.push(w),l||(f[C]=w))}c(a.beforeMove,S),d.a.r(b,a.beforeRemove?d.M:d.removeNode);for(var _,C=0,l=d.e.firstChild(r);w=y[C];C++){for(w.S||d.a.extend(w,t(r,o,w.ka,s,w.Ia)),v=0;p=w.S[v];l=p.nextSibling,_=p,v++)p!==l&&d.e.rb(r,p,_);!w.Zb&&s&&(s(w.ka,w.S,w.Ia),w.Zb=!0)}c(a.beforeRemove,i),c(a.afterMove,S),c(a.afterAdd,f),d.a.f.set(r,n,m)}}(),d.b("utils.setDomNodeChildrenFromArrayMapping",d.a.Ua),d.K=function(){this.allowTemplateRewriting=!1},d.K.prototype=new d.C,d.K.prototype.renderTemplateSource=function(e){var t=(9>d.a.oa?0:e.nodes)?e.nodes():null;return t?d.a.R(t.cloneNode(!0).childNodes):(e=e.text(),d.a.Qa(e))},d.K.Ja=new d.K,d.Wa(d.K.Ja),d.b("nativeTemplateEngine",d.K),function(){d.La=function(){var e=this.ac=function(){if(!i||!i.tmpl)return 0;try{if(0<=i.tmpl.tag.tmpl.open.toString().indexOf("__"))return 2}catch(e){}return 1}();this.renderTemplateSource=function(t,r,o){if(o=o||{},2>e)throw Error("Your version of jQuery.tmpl is too old. Please upgrade to jQuery.tmpl 1.0.0pre or later.");var a=t.data("precompiled");return a||(a=t.text()||"",a=i.template(null,"{{ko_with $item.koBindingContext}}"+a+"{{/ko_with}}"),t.data("precompiled",a)),t=[r.$data],r=i.extend({koBindingContext:r},o.templateOptions),r=i.tmpl(a,t,r),r.appendTo(n.createElement("div")),i.fragments={},r},this.createJavaScriptEvaluatorBlock=function(e){return"{{ko_code ((function() { return "+e+" })()) }}"},this.addTemplate=function(e,t){n.write("<script type='text/html' id='"+e+"'>"+t+"</script>")},e>0&&(i.tmpl.tag.ko_code={open:"__.push($1 || '');"},i.tmpl.tag.ko_with={open:"with($1) {",close:"} "})},d.La.prototype=new d.C;var e=new d.La;0<e.ac&&d.Wa(e),d.b("jqueryTmplTemplateEngine",d.La)}()})}()}(),function(e){"function"==typeof require&&"object"==typeof exports&&"object"==typeof module?e(require("knockout"),exports):"function"==typeof define&&define.amd?define(["knockout","exports"],e):e(ko,ko.validation={})}(function(e,t){function n(e,n,r){return n.validator(e(),void 0===r.params?!0:r.params)?!0:(e.error=t.formatMessage(r.message||n.message,r.params),e.__valid__(!1),!1)}function r(e,n,r){e.isValidating(!0);var i=function(i){var o=!1,a="";return e.__valid__()?(i.message?(o=i.isValid,a=i.message):o=i,o||(e.error=t.formatMessage(a||r.message||n.message,r.params),e.__valid__(o)),e.isValidating(!1),void 0):void e.isValidating(!1)};n.validator(e(),r.params||!0,i)}if(void 0===typeof e)throw"Knockout is required, please ensure it is loaded before loading this validation plug-in";"function"==typeof define&&define.amd&&(t=e.validation={});var i={registerExtenders:!0,messagesOnModified:!0,errorsAsTitleOnModified:!1,messageTemplate:null,insertMessages:!0,parseInputAttributes:!1,writeInputAttributes:!1,decorateElement:!1,errorClass:null,errorElementClass:"validationElement",errorMessageClass:"validationMessage",grouping:{deep:!1,observable:!0}},o=e.utils.extend({},i),a=["required","pattern","min","max","step"],s=function(e){window.setImmediate?window.setImmediate(e):window.setTimeout(e,0)},u=function(){var e=(new Date).getTime(),t={},n="__ko_validation__";return{isArray:function(e){return e.isArray||"[object Array]"===Object.prototype.toString.call(e)},isObject:function(e){return null!==e&&"object"==typeof e},values:function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(e[n]);return t},getValue:function(e){return"function"==typeof e?e():e},hasAttribute:function(e,t){return null!==e.getAttribute(t)},isValidatable:function(e){return e&&e.rules&&e.isValid&&e.isModified},insertAfter:function(e,t){e.parentNode.insertBefore(t,e.nextSibling)},newId:function(){return e+=1},getConfigOptions:function(e){var t=u.contextFor(e);return t||o},setDomData:function(e,r){var i=e[n];i||(e[n]=i=u.newId()),t[i]=r},getDomData:function(e){var r=e[n];return r?t[r]:void 0},contextFor:function(e){switch(e.nodeType){case 1:case 8:var t=u.getDomData(e);if(t)return t;if(e.parentNode)return u.contextFor(e.parentNode)}return void 0},isEmptyVal:function(e){return void 0===e?!0:null===e?!0:""===e?!0:void 0}}}(),c=function(){var n=0;return{utils:u,init:function(r,i){n>0&&!i||(r=r||{},r.errorElementClass=r.errorElementClass||r.errorClass||o.errorElementClass,r.errorMessageClass=r.errorMessageClass||r.errorClass||o.errorMessageClass,e.utils.extend(o,r),o.registerExtenders&&t.registerExtenders(),n=1)},configure:function(e){t.init(e)},reset:function(){o=$.extend(o,i)},group:function r(t,n){var n=e.utils.extend(o.grouping,n),i=e.observableArray([]),a=null,r=function s(t,r){var o=[],a=e.utils.unwrapObservable(t);r=void 0!==r?r:n.deep?1:-1,e.isObservable(t)&&(t.isValid||t.extend({validatable:!0}),i.push(t)),a&&(u.isArray(a)?o=a:u.isObject(a)&&(o=u.values(a))),0!==r&&e.utils.arrayForEach(o,function(e){e&&!e.nodeType&&s(e,r+1)})};return n.observable?(r(t),a=e.computed(function(){var t=[];return e.utils.arrayForEach(i(),function(e){e.isValid()||t.push(e.error)}),t})):a=function(){var n=[];return i([]),r(t),e.utils.arrayForEach(i(),function(e){e.isValid()||n.push(e.error)}),n},a.showAllMessages=function(t){void 0==t&&(t=!0),a(),e.utils.arrayForEach(i(),function(e){e.isModified(t)})},t.errors=a,t.isValid=function(){return 0===t.errors().length},t.isAnyMessageShown=function(){var t=!1;return a(),e.utils.arrayForEach(i(),function(e){!e.isValid()&&e.isModified()&&(t=!0)}),t},a},formatMessage:function(e,t){return"function"==typeof e?e(t):e.replace(/\{0\}/gi,t)},addRule:function(e,t){return e.extend({validatable:!0}),e.rules.push(t),e},addAnonymousRule:function(e,n){var r=u.newId();void 0===n.message&&(n.message="Error"),t.rules[r]=n,t.addRule(e,{rule:r,params:n.params})},addExtender:function(n){e.extenders[n]=function(e,r){return r.message||r.onlyIf?t.addRule(e,{rule:n,message:r.message,params:u.isEmptyVal(r.params)?!0:r.params,condition:r.onlyIf}):t.addRule(e,{rule:n,params:r})}},registerExtenders:function(){if(o.registerExtenders)for(var n in t.rules)t.rules.hasOwnProperty(n)&&(e.extenders[n]||t.addExtender(n))},insertValidationMessage:function(e){var t=document.createElement("SPAN");return t.className=u.getConfigOptions(e).errorMessageClass,u.insertAfter(e,t),t},parseInputValidationAttributes:function(n,r){e.utils.arrayForEach(a,function(e){u.hasAttribute(n,e)&&t.addRule(r(),{rule:e,params:n.getAttribute(e)||!0})})},writeInputValidationAttributes:function(t,n){var r=n();if(r&&r.rules){var i=r.rules();e.utils.arrayForEach(a,function(n){var r,o=e.utils.arrayFirst(i,function(e){return e.rule.toLowerCase()===n.toLowerCase()});o&&(r=o.params,"pattern"==o.rule&&o.params instanceof RegExp&&(r=o.params.source),t.setAttribute(n,r))}),i=null}}}}();c.rules={},c.rules.required={validator:function(e,t){var n,r=/^\s+|\s+$/g;return void 0===e||null===e?!t:(n=e,"string"==typeof e&&(n=e.replace(r,"")),t?(n+"").length>0:!0)},message:"This field is required."},c.rules.min={validator:function(e,t){return u.isEmptyVal(e)||e>=t},message:"Please enter a value greater than or equal to {0}."},c.rules.max={validator:function(e,t){return u.isEmptyVal(e)||t>=e},message:"Please enter a value less than or equal to {0}."},c.rules.minLength={validator:function(e,t){return u.isEmptyVal(e)||e.length>=t},message:"Please enter at least {0} characters."},c.rules.maxLength={validator:function(e,t){return u.isEmptyVal(e)||e.length<=t},message:"Please enter no more than {0} characters."},c.rules.pattern={validator:function(e,t){return u.isEmptyVal(e)||null!=e.match(t)},message:"Please check this value."},c.rules.step={validator:function(e,t){return u.isEmptyVal(e)||100*e%(100*t)===0},message:"The value must increment by {0}"},c.rules.email={validator:function(e,t){return t?u.isEmptyVal(e)||t&&/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(e):!0},message:"Please enter a proper email address"},c.rules.date={validator:function(e,t){return t?u.isEmptyVal(e)||t&&!/Invalid|NaN/.test(new Date(e)):!0},message:"Please enter a proper date"},c.rules.dateISO={validator:function(e,t){return t?u.isEmptyVal(e)||t&&/^\d{4}[\/-]\d{1,2}[\/-]\d{1,2}$/.test(e):!0},message:"Please enter a proper date"},c.rules.number={validator:function(e,t){return t?u.isEmptyVal(e)||t&&/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/.test(e):!0},message:"Please enter a number"},c.rules.digit={validator:function(e,t){return t?u.isEmptyVal(e)||t&&/^\d+$/.test(e):!0},message:"Please enter a digit"},c.rules.phoneUS={validator:function(e,t){return t?"string"!=typeof e?!1:u.isEmptyVal(e)?!0:(e=e.replace(/\s+/g,""),t&&e.length>9&&e.match(/^(1-?)?(\([2-9]\d{2}\)|[2-9]\d{2})-?[2-9]\d{2}-?\d{4}$/)):!0},message:"Please specify a valid phone number"},c.rules.equal={validator:function(e,t){var n=t;return e===u.getValue(n)},message:"Values must equal"},c.rules.notEqual={validator:function(e,t){var n=t;return e!==u.getValue(n)},message:"Please choose another value."},c.rules.unique={validator:function(t,n){var r=u.getValue(n.collection),i=u.getValue(n.externalValue),o=0;return t&&r?(e.utils.arrayFilter(e.utils.unwrapObservable(r),function(e){t===(n.valueAccessor?n.valueAccessor(e):e)&&o++}),(void 0!==i&&t!==i?1:2)>o):!0},message:"Please make sure the value is unique."},function(){c.registerExtenders()}(),e.bindingHandlers.validationCore=function(){return{init:function(n,r){var i=u.getConfigOptions(n);if(i.parseInputAttributes&&s(function(){t.parseInputValidationAttributes(n,r)}),i.insertMessages&&u.isValidatable(r())){var o=t.insertValidationMessage(n);i.messageTemplate?e.renderTemplate(i.messageTemplate,{field:r()},null,o,"replaceNode"):e.applyBindingsToNode(o,{validationMessage:r()})}i.writeInputAttributes&&u.isValidatable(r())&&t.writeInputValidationAttributes(n,r),i.decorateElement&&u.isValidatable(r())&&e.applyBindingsToNode(n,{validationElement:r()})},update:function(){}}}(),function(){var t=e.bindingHandlers.value.init;e.bindingHandlers.value.init=function(n,r,i,o,a){return t(n,r,i),e.bindingHandlers.validationCore.init(n,r,i,o,a)}}(),e.bindingHandlers.validationMessage={update:function(t,n){var r=n(),i=u.getConfigOptions(t),o=(e.utils.unwrapObservable(r),!1),a=!1;r.extend({validatable:!0}),o=r.isModified(),a=r.isValid();var s=function(){return!i.messagesOnModified||o?a?null:r.error:null},c=function(){return o?!a:!1};e.bindingHandlers.text.update(t,s),e.bindingHandlers.visible.update(t,c)}},e.bindingHandlers.validationElement={update:function(t,n){var r=n(),i=u.getConfigOptions(t),o=(e.utils.unwrapObservable(r),!1),a=!1;r.extend({validatable:!0}),o=r.isModified(),a=r.isValid();var s=function(){var e={},t=o?!a:!1;return i.decorateElement||(t=!1),e[i.errorElementClass]=t,e};e.bindingHandlers.css.update(t,s);var c=t.getAttribute("data-orig-title"),l=t.title,d=("true"==t.getAttribute("data-orig-title"),function(){return!i.errorsAsTitleOnModified||o?a?{title:c||l,"data-orig-title":null}:{title:r.error,"data-orig-title":c||l}:void 0});e.bindingHandlers.attr.update(t,d)}},e.bindingHandlers.validationOptions=function(){return{init:function(t,n){var r=e.utils.unwrapObservable(n());if(r){var i=e.utils.extend({},o);e.utils.extend(i,r),u.setDomData(t,i)}}}}(),e.extenders.validation=function(n,r){return e.utils.arrayForEach(u.isArray(r)?r:[r],function(e){t.addAnonymousRule(n,e)}),n},e.extenders.validatable=function(n,r){if(r&&!u.isValidatable(n)){n.error=null,n.rules=e.observableArray(),n.isValidating=e.observable(!1),n.__valid__=e.observable(!0),n.isModified=e.observable(!1);var i=e.computed(function(){n(),n.rules();return t.validateObservable(n),!0});n.isValid=e.computed(function(){return n.__valid__()});var o=n.subscribe(function(){n.isModified(!0)});n._disposeValidation=function(){n.isValid.dispose(),n.rules.removeAll(),n.isModified._subscriptions.change=[],n.isValidating._subscriptions.change=[],n.__valid__._subscriptions.change=[],o.dispose(),i.dispose(),delete n.rules,delete n.error,delete n.isValid,delete n.isValidating,delete n.__valid__,delete n.isModified}}else r===!1&&u.isValidatable(n)&&n._disposeValidation&&n._disposeValidation();return n},c.validateObservable=function(e){for(var i,o,a=0,s=e.rules(),u=s.length;u>a;a++)if(o=s[a],!o.condition||o.condition())if(i=t.rules[o.rule],i.async||o.async)r(e,i,o);else if(!n(e,i,o))return!1;return e.error=null,e.__valid__(!0),!0},e.validatedObservable=function(n){if(!t.utils.isObject(n))return e.observable(n).extend({validatable:!0});var r=e.observable(n);return r.errors=t.group(n),r.isValid=e.computed(function(){return 0===r.errors().length}),r},c.localize=function(e){var n;for(n in e)t.rules.hasOwnProperty(n)&&(t.rules[n].message=e[n])},e.applyBindingsWithValidation=function(n,r,i){var o,a,s=arguments.length;s>2?(o=r,a=i):2>s?o=document.body:arguments[1].nodeType?o=r:a=arguments[1],t.init(),a&&t.utils.setDomData(o,a),e.applyBindings(n,r)};var l=e.applyBindings;e.applyBindings=function(e,n){t.init(),l(e,n)},e.utils.extend(t,c)}),initJQueryPayments=function(e){var t,n,r,i,o,a,s,u,c,l,d,h,f,p,m,v,g,b,y,w=[].slice,k=[].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(t in this&&this[t]===e)return t;return-1};t=e,t.payment={},t.payment.fn={},t.fn.payment=function(){var e,n;return n=arguments[0],e=2<=arguments.length?w.call(arguments,1):[],t.payment.fn[n].apply(this,e)},o=/(\d{1,4})/g,i=[{type:"maestro",pattern:/^(5018|5020|5038|6304|6759|676[1-3])/,format:o,length:[12,13,14,15,16,17,18,19],cvcLength:[3],luhn:!0},{type:"dinersclub",pattern:/^(36|38|30[0-5])/,format:o,length:[14],cvcLength:[3],luhn:!0},{type:"laser",pattern:/^(6706|6771|6709)/,format:o,length:[16,17,18,19],cvcLength:[3],luhn:!0},{type:"jcb",pattern:/^35/,format:o,length:[16],cvcLength:[3],luhn:!0},{type:"unionpay",pattern:/^62/,format:o,length:[16,17,18,19],cvcLength:[3],luhn:!1},{type:"discover",pattern:/^(6011|65|64[4-9]|622)/,format:o,length:[16],cvcLength:[3],luhn:!0},{type:"mastercard",pattern:/^5[1-5]/,format:o,length:[16],cvcLength:[3],luhn:!0},{type:"amex",pattern:/^3[47]/,format:/(\d{1,4})(\d{1,6})?(\d{1,5})?/,length:[15],cvcLength:[3,4],luhn:!0},{type:"visa",pattern:/^4/,format:o,length:[13,14,15,16],cvcLength:[3],luhn:!0}],n=function(e){var t,n,r;for(e=(e+"").replace(/\D/g,""),n=0,r=i.length;r>n;n++)if(t=i[n],t.pattern.test(e))return t},r=function(e){var t,n,r;for(n=0,r=i.length;r>n;n++)if(t=i[n],t.type===e)return t},f=function(e){var t,n,r,i,o,a;for(r=!0,i=0,n=(e+"").split("").reverse(),o=0,a=n.length;a>o;o++)t=n[o],t=parseInt(t,10),(r=!r)&&(t*=2),t>9&&(t-=9),i+=t;return i%10===0},h=function(e){var t;return null!=e.prop("selectionStart")&&e.prop("selectionStart")!==e.prop("selectionEnd")?!0:("undefined"!=typeof document&&null!==document&&null!=(t=document.selection)&&"function"==typeof t.createRange?t.createRange().text:void 0)?!0:!1},p=function(e){return setTimeout(function(){var n,r;return n=t(e.currentTarget),r=n.val(),r=t.payment.formatCardNumber(r),n.val(r)})},u=function(e){var r,i,o,a,s,u,c;return o=String.fromCharCode(e.which),!/^\d+$/.test(o)||(r=t(e.currentTarget),c=r.val(),i=n(c+o),a=(c.replace(/\D/g,"")+o).length,u=16,i&&(u=i.length[i.length.length-1]),a>=u||null!=r.prop("selectionStart")&&r.prop("selectionStart")!==c.length)?void 0:(s=i&&"amex"===i.type?/^(\d{4}|\d{4}\s\d{6})$/:/(?:^|\s)(\d{4})$/,s.test(c)?(e.preventDefault(),r.val(c+" "+o)):s.test(c+o)?(e.preventDefault(),r.val(c+o+" ")):void 0)},a=function(e){var n,r;return n=t(e.currentTarget),r=n.val(),e.meta||8!==e.which||null!=n.prop("selectionStart")&&n.prop("selectionStart")!==r.length?void 0:/\d\s$/.test(r)?(e.preventDefault(),n.val(r.replace(/\d\s$/,""))):/\s\d?$/.test(r)?(e.preventDefault(),n.val(r.replace(/\s\d?$/,""))):void 0},c=function(e){var n,r,i;return r=String.fromCharCode(e.which),/^\d+$/.test(r)?(n=t(e.currentTarget),i=n.val()+r,/^\d$/.test(i)&&"0"!==i&&"1"!==i?(e.preventDefault(),n.val("0"+i+" / ")):/^\d\d$/.test(i)?(e.preventDefault(),n.val(""+i+" / ")):void 0):void 0},l=function(e){var n,r,i;return r=String.fromCharCode(e.which),/^\d+$/.test(r)?(n=t(e.currentTarget),i=n.val(),/^\d\d$/.test(i)?n.val(""+i+" / "):void 0):void 0},d=function(e){var n,r,i;return r=String.fromCharCode(e.which),"/"===r?(n=t(e.currentTarget),i=n.val(),/^\d$/.test(i)&&"0"!==i?n.val("0"+i+" / "):void 0):void 0},s=function(e){var n,r;if(!e.meta&&(n=t(e.currentTarget),r=n.val(),8===e.which&&(null==n.prop("selectionStart")||n.prop("selectionStart")===r.length)))return/\d(\s|\/)+$/.test(r)?(e.preventDefault(),n.val(r.replace(/\d(\s|\/)*$/,""))):/\s\/\s?\d?$/.test(r)?(e.preventDefault(),n.val(r.replace(/\s\/\s?\d?$/,""))):void 0},b=function(e){var t;return e.metaKey||e.ctrlKey?!0:32===e.which?!1:0===e.which?!0:e.which<33?!0:(t=String.fromCharCode(e.which),!!/[\d\s]/.test(t))},v=function(e){var r,i,o,a;return r=t(e.currentTarget),o=String.fromCharCode(e.which),/^\d+$/.test(o)&&!h(r)?(a=(r.val()+o).replace(/\D/g,""),i=n(a),i?a.length<=i.length[i.length.length-1]:a.length<=16):void 0},g=function(e){var n,r,i;return n=t(e.currentTarget),r=String.fromCharCode(e.which),/^\d+$/.test(r)&&!h(n)?(i=n.val()+r,i=i.replace(/\D/g,""),i.length>6?!1:void 0):void 0},m=function(e){var n,r,i;return n=t(e.currentTarget),r=String.fromCharCode(e.which),/^\d+$/.test(r)?(i=n.val()+r,i.length<=4):void 0},y=function(e){var n,r,o,a,s;return n=t(e.currentTarget),s=n.val(),a=t.payment.cardType(s)||"unknown",n.hasClass(a)?void 0:(r=function(){var e,t,n;for(n=[],e=0,t=i.length;t>e;e++)o=i[e],n.push(o.type);return n}(),n.removeClass("unknown"),n.removeClass(r.join(" ")),n.addClass(a),n.toggleClass("identified","unknown"!==a),n.trigger("payment.cardType",a))},t.payment.fn.formatCardCVC=function(){return this.payment("restrictNumeric"),this.on("keypress",m),this},t.payment.fn.formatCardExpiry=function(){return this.payment("restrictNumeric"),this.on("keypress",g),this.on("keypress",c),this.on("keypress",d),this.on("keypress",l),this.on("keydown",s),this},t.payment.fn.formatCardNumber=function(){return this.payment("restrictNumeric"),this.on("keypress",v),this.on("keypress",u),this.on("keydown",a),this.on("keyup",y),this.on("paste",p),this},t.payment.fn.restrictNumeric=function(){return this.on("keypress",b),this},t.payment.fn.cardExpiryVal=function(){return t.payment.cardExpiryVal(t(this).val())},t.payment.cardExpiryVal=function(e){var t,n,r,i;return e=e.replace(/\s/g,""),i=e.split("/",2),t=i[0],r=i[1],2===(null!=r?r.length:void 0)&&/^\d+$/.test(r)&&(n=(new Date).getFullYear(),n=n.toString().slice(0,2),r=n+r),t=parseInt(t,10),r=parseInt(r,10),{month:t,year:r}},t.payment.validateCardNumber=function(e){var t,r;return e=(e+"").replace(/\s+|-/g,""),/^\d+$/.test(e)?(t=n(e),t?(r=e.length,k.call(t.length,r)>=0&&(t.luhn===!1||f(e))):!1):!1},t.payment.validateCardExpiry=function(e,n){var r,i,o,a;return"object"==typeof e&&"month"in e&&(a=e,e=a.month,n=a.year),e&&n?(e=t.trim(e),n=t.trim(n),/^\d+$/.test(e)&&/^\d+$/.test(n)&&parseInt(e,10)<=12?(2===n.length&&(o=(new Date).getFullYear(),o=o.toString().slice(0,2),n=o+n),i=new Date(n,e),r=new Date,i.setMonth(i.getMonth()-1),i.setMonth(i.getMonth()+1,1),i>r):!1):!1},t.payment.validateCardCVC=function(e,n){var i,o;return e=t.trim(e),/^\d+$/.test(e)?n?(i=e.length,k.call(null!=(o=r(n))?o.cvcLength:void 0,i)>=0):e.length>=3&&e.length<=4:!1},t.payment.cardType=function(e){var t;return e?(null!=(t=n(e))?t.type:void 0)||null:null},t.payment.formatCardNumber=function(e){var t,r,i,o;return(t=n(e))?(i=t.length[t.length.length-1],e=e.replace(/\D/g,""),e=e.slice(0,+i+1||9e9),t.format.global?null!=(o=e.match(t.format))?o.join(" "):void 0:(r=t.format.exec(e),null!=r&&r.shift(),null!=r?r.join(" "):void 0)):e}};var DonationsFormModel,html,__indexOf=[].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(t in this&&this[t]===e)return t;return-1};html='<div class="cleanslate donations-callback-flash">\n  Success! You\'ll receive a notification for your payment. \n</div>\n\n<meta name="viewport" content="width=device-width, initial-scale=1">\n<form class="cleanslate donation-form" id="donation-form" autocomplete="on">\n  <div class="donation-loading-overlay"></div>\n  <input type="hidden" name="organization_slug" data-bind="value: org">\n  <input type="hidden" name="customer.country" data-bind="value: countryCode">\n  <input type="hidden" name="customer.charges_attributes[0].currency" data-bind="value: selectedCurrency">\n  <div class="donation-header">\n    <div class="donation-header-main-message">\n      I\'M DONATING\n    </div>\n    <div class="donation-subheader-amount">\n      <span class=\'donation-currency\' data-bind="html: currencySymbol">$</span><span class=\'donation-header-amt\' data-bind="text: displayAmount()">0</span>\n    </div>\n  </div>\n  <div class="donation-progress-banner">\n    <div class="donation-progress-banner-container">\n      <span class="donation-progress-header" id="dnt-progress-amount" data-bind="css: { \'dph-active\' : visibleInputSet() >= 0}, click: function() { setInputSet(0); }">\n        Amount\n      </span>\n      <span class="donation-progress-arrow"></span>\n      <span class="donation-progress-header" id="dnt-progress-myinfo" data-bind="css: { \'dph-active\' : visibleInputSet() >= 1}, click: function() { setInputSet(1); }">\n        My Info\n      </span>\n      <span class="donation-progress-arrow"></span>\n      <span class="donation-progress-header" id="dnt-progress-payment" data-bind="css: { \'dph-active\' : visibleInputSet() >= 2}, click: function() { setInputSet(2); }">\n        Payment\n      </span>\n    </div>\n  </div>\n  <div class="donation-input-set" id="input-set-first" data-bind="visible: visibleInputSet() === 0">\n    <div class="donations-currency-select-row" data-bind="visible: currenciesEnabled()">\n      Currency: \n      <select class="donations-currency-select" data-bind="options: currenciesArray, value: selectedCurrency"></select>\n    </div>\n    <span class="donation-field-label">\n      <span class="donation-error-label" id="d-error-label-first" data-bind="validationMessage: displayAmount"></span>\n    </span>\n    <div class="donation-button-set" data-bind="foreach: amounts">\n      <div class="donation-btn donation-btn-sm" data-bind="css: { \'donation-btn-active\' : $parent.selectedBtn() === $index() }, click: function() { $parent.setActiveAmount($index()); }">\n        <span class=\'donation-currency\' data-bind="html: $parent.currencySymbol">$</span><span class=\'donation-amt\' data-bind="text: $data"></span>\n      </div>\n      <!-- ko if: $index() === ($parent.amountsLength() - 1) -->\n        <input class="donation-btn donation-btn-lg" data-bind="value: $parent.inputtedAmount, event: { change: $parent.clearSelectedButton } " type="text" placeholder="Other amount">\n      <!-- /ko -->\n    </div>\n    <div class="donation-next-btn" id="donation-first-next-btn" data-bind="click: function()\n        { \n          if(inputSet1.isValid()) { incrementInputSet(); } \n          else { inputSet1.errors.showAllMessages();}\n        }">\n      <div class="donation-next-btn-header">\n        NEXT\n      </div>\n    </div>\n  </div>\n  \n  <div class="donation-input-set" data-bind="visible: visibleInputSet() === 1">\n    <div class="donation-input-row">\n      <span class="donation-field-label">\n        First Name*\n        <span class="donation-error-label" data-bind="validationMessage: firstName">Can\'t be blank</span>\n      </span>\n      \n      <input type="text" class="donation-text-field" autocompletetype="given-name" name="customer.first_name" data-bind="value: firstName">\n    </div>\n    <div class="donation-input-row">      \n      <span class="donation-field-label">\n        Last Name*\n        <span class="donation-error-label" data-bind="validationMessage: lastName">Can\'t be blank</span>\n      </span>\n      \n      <input type="text" class="donation-text-field" autocompletetype="family-name" name="customer.last_name" data-bind="value: lastName">\n    </div>\n    <div class="donation-input-row"> \n      <span class="donation-field-label">\n        Email*\n        <span class="donation-error-label" data-bind="validationMessage: email">Invalid email format</span>\n      </span>\n      \n      <input type="email" class="donation-text-field" autocompletetype="email" name="customer.email" data-bind="value: email">\n    </div>\n    <div class="donation-next-btn" id="donation-second-next-btn" data-bind="click: function()\n        { \n          if(inputSet2.isValid()) { incrementInputSet(); } \n          else { inputSet2.errors.showAllMessages();}\n        }">\n      <div class="donation-next-btn-header">\n        NEXT\n      </div>\n    </div>\n  </div>\n  \n  <div class="donation-input-set" data-bind="visible: visibleInputSet() === 2">\n    <div class="donation-input-row">\n      <span class="donation-field-label">\n        Card Number*\n        <span class="donation-error-label" data-bind="validationMessage: cardNumber" data-bind="validationMessage: cardDate">Invalid number</span>\n      </span>\n      <input name="cc-num" id="cc-num-input" type="cc-num" class="donation-text-field" autocompletetype="cc-number" data-stripe="number" data-bind="value: cardNumber, event: {keydown: calcCardType}, style: { backgroundImage: ccBackground() } ">\n    </div>\n    <div class="donation-input-row"> \n      <span class="donation-field-label">\n        Expiration*\n        <span class="donation-error-label" data-bind="validationMessage: cardDate">Invalid date</span>\n      </span>\n      <select name="month" class="donation-select" type="month" data-stripe="exp-month" data-bind="value: cardMonth, options: ccMonths">\n      </select>\n      <select name="year" class="donation-select" type="year" data-stripe="exp-year" data-bind="value: cardYear, options: ccYears">\n      </select>\n    </div>\n    <div class="donation-input-row"> \n      <span class="donation-field-label">\n        CVV/CVC* <a class="what-is-cvv" title="For MasterCard, Visa or Discover, it\'s the three digits in the signature area on the back of your card. For American Express, it\'s the four digits on the front of the card.">What is this?</a>\n        <span class="donation-error-label" data-bind="validationMessage: cvc">Invalid CVV number</span>\n      </span>\n      <input name="cvc" type="cvc" class="donation-text-field donation-text-field-sm" autocomplete="off" data-stripe="cvc" data-bind="value: cvc">\n    </div>\n    <div class="donation-payment-errors" data-bind="visible: false">\n      Something went wrong.\n    </div>\n    <button type="submit" class="donation-submit" data-bind="click: function()\n        { \n          if(inputSet3.isValid()) { submitForm(); } \n          else { inputSet3.errors.showAllMessages();}\n        }">\n      <div class="donation-submit-header">\n        SUBMIT\n      </div>\n    </div>\n  </div>\n</form>',DonationsFormModel=function(){function e(e,t){var n,r,i;i=this,$=e,n=$.extend({},{imgpath:"https://d2yuwrm8xcn0u8.cloudfront.net",metaviewporttag:!0},t,i.parseQueryString(document.URL.split("?")[1])),ko.validation.configure({insertMessages:!1}),ko.validation.rules.ccDate={validator:function(e){return $.payment.validateCardExpiry(e.month,e.year)
},message:"Invalid date"},ko.validation.rules.ccNum={validator:function(e){return $.payment.validateCardNumber(e)},message:"Invalid credit card number"},ko.validation.rules.cvc={validator:function(e){return $.payment.validateCardCVC(e)},message:"Invalid CVC number"},ko.validation.registerExtenders(),i.org=ko.observable(n.org),i.countryCode=ko.observable("US"),i.imgPath=ko.observable(n.imgpath),i.initializeIcons(i.imgPath()),i.seedAmount=n.seedamount||100,i.seedValues=null!=n.seedvalues?n.seedvalues.split(","):[15,35,50,100,250,500,1e3],i.currencies={US:"USD",GB:"GBP",AU:"AUD",CA:"CAD",SE:"SEK",NO:"NOK",DK:"DKK",NZ:"NZD"},i.currenciesArray=ko.observableArray(["USD","GBP","CAD","AUD","EUR","NZD","SEK","NOK","DKK"]),i.currenciesEnabled=ko.observable("none"!==n.currencyconversion),i.seededCurrency=n.seedcurrency||"USD",i.formCurrency=n.formcurrency||i.seededCurrency,r=function(){var e;return"none"!==(e=n.currencyconversion)&&"choose"!==e?i.currencies[n.country]:i.formCurrency},i.selectedCurrency=ko.observable(r()),i.currencySymbol=ko.computed(function(){var e;return e={USD:"$",GBP:"&pound;",EUR:"&euro;",NZD:"NZ$",AUD:"AU$",CAD:"C$"},e[i.selectedCurrency()]||i.selectedCurrency()},this),i.selectedBtn=ko.observable(-1),i.selectedAmount=ko.observable("0"),i.inputtedAmount=ko.observable(null),i.displayAmount=ko.computed(function(){return i.inputtedAmount()||i.selectedAmount()},this).extend({required:{message:"Please select an amount"},min:1,digit:!0}),i.normalizedAmount=ko.computed(function(){var e,t;return e=["BIF","CLP","JPY","KRW","PYG","VUV","XOF","CLP","GNF","KMF","MGA","RWF","XAF","XPF"],t=i.selectedCurrency(),__indexOf.call(e,t)>=0?i.displayAmount():i.displayAmount()+"00"},this),i.setActiveAmount=function(e){return e>-1?(i.inputtedAmount(null),i.selectedAmount(i.amounts()[e]),i.selectedBtn(e)):void 0},i.clearSelectedButton=function(){return i.selectedAmount(0),i.selectedBtn(-1)},i.amounts=ko.computed(function(){var e,t,r,o,a,s,u,c,l;for(e=[],l=i.seedValues,a=u=0,c=l.length;c>u;a=++u)s=l[a],t=parseInt(s)/100*parseInt(i.seedAmount),7>a&&(i.currenciesEnabled()?(o=n[i.selectedCurrency()]||1,r=n[i.seededCurrency]||1,e.push(i.round(t*o/r))):e.push(i.round(t)));return e},this),i.amountsLength=ko.computed(function(){return i.amounts().length},this),i.visibleInputSet=ko.observable(0),i.incrementInputSet=function(){return i.visibleInputSet(i.visibleInputSet()+1)},i.setInputSet=function(e){return i.visibleInputSet(e)},i.firstName=ko.observable().extend({required:{message:"Can't be blank"}}),i.lastName=ko.observable().extend({required:{message:"Can't be blank"}}),i.email=ko.observable().extend({required:{message:"Can't be blank"},email:{message:"Invalid email"}}),i.cardNumber=ko.observable().extend({required:{message:"Can't be blank"},ccNum:!0}),i.cardMonth=ko.observable(),i.ccMonths=["01","02","03","04","05","06","07","08","09","10","11","12"],i.cardYear=ko.observable(""+((new Date).getFullYear()+1)),i.ccYears=function(){var e,t,n,r,i;for(e=[],t=(new Date).getFullYear(),n=r=t,i=t+19;i>=t?i>=r:r>=i;n=i>=t?++r:--r)e.push(""+n);return e}(),i.cardDate=ko.computed(function(){return{month:i.cardMonth(),year:i.cardYear()}},this).extend({ccDate:!0,observable:!0}),i.cvc=ko.observable().extend({required:{message:"Can't be blank"},digit:!0,cvc:!0}),$('.donation-text-field[type="cc-num"]').payment("formatCardNumber"),$('.donation-text-field[type="cvc"]').payment("formatCardCVC"),i.ccType=ko.observable(),i.calcCardType=function(){return i.ccType($.payment.cardType($("#cc-num-input").val())),!0},i.ccBackground=ko.computed(function(){var e;return"amex"===(e=i.ccType())||"mastercard"===e||"visa"===e||"discover"===e||"dinersclub"===e?"url("+i.imgPath()+"/icon-cc-"+i.ccType()+".png)":"url("+i.imgPath()+"/icon-cc-none.png)"},this),i.inputSet1=ko.validatedObservable({amount:i.displayAmount}),i.inputSet2=ko.validatedObservable({firstName:i.firstName,lastName:i.lastName,email:i.email}),i.inputSet3=ko.validatedObservable({cardNumber:i.cardNumber,cardDate:i.cardDate,cvc:i.cvc}),i.connectToServer(n,i)}return e.prototype.parseQueryString=function(e){var t,n,r;if(t={},void 0!==e&&""!==e)for(e=e.split("&"),n=0;n<e.length;)r=e[n].split("="),t[r[0]]=r[1],n++;return t},e.prototype.initializeIcons=function(e){var t,n,r,i;t={"#dnt-progress-amount":"icon-amount.png","#dnt-progress-myinfo":"icon-myinfo.png","#dnt-progress-payment":"icon-payment.png",".donation-progress-arrow":"icon-arrow.png",'.donation-text-field[type="cc-num"]':"icon-cc-none.png",".donation-select":"icon-dropdown-arrows.png",".donation-loading-overlay":"712.GIF"},i=[];for(n in t)r=t[n],i.push($(n).css("background-image","url('"+e+"/"+r+"')"));return i},e.prototype.round=function(e){var t;return t=Math.round(parseFloat(e.toPrecision(2))),0===t?1:t},e.prototype.connectToServer=function(e,t){var n,r,i;return n=$.extend({},{stripepublickey:"pk_test_LGrYxpfzI89s9yxXJfKcBB0R",pusherpublickey:"331ca3447b91e264a76f",pathtoserver:"http://localhost:3000"},e),Stripe.setPublishableKey(n.stripepublickey),i=function(e){var t,r;return r=new Pusher(n.pusherpublickey),t=r.subscribe(e),t.bind("charge_completed",function(e){return $(".donation-loading-overlay").hide(),r.disconnect(),"success"===e.status?($("#donation-script").trigger("donations:success"),null!=n.redirectto&&window.location.replace(n.redirectto),$("#donation-form").hide(),$(".donations-callback-flash").show(0).delay(8e3).hide(0)):$(".donation-payment-errors").text(e.message||"Something went wrong.").show()})},r=function(e,r){var o,a,s,u,c;return o=$("#donation-form"),r.error?(gaDonations("send","event","advance-button","click#with-errors","submit",1),o.find(".donation-payment-errors").text(r.error.message),o.find("button").prop("disabled",!1),$(".donation-loading-overlay").hide()):(a={},a.amount=t.normalizedAmount(),a.currency=t.selectedCurrency(),s={},s.first_name=t.firstName(),s.last_name=t.lastName(),s.email=t.email(),s.country=t.countryCode(),s.charges_attributes=[a],u={},u.customer=s,u.card_token=r.id,u.config=n,u.organization_slug=t.org(),c=$.ajax({url:""+n.pathtoserver+"/charges",type:"post",dataType:"json",contentType:"application/json",data:JSON.stringify(u)}),c.done(function(e){return gaDonations("send","event","advance-button","click#success","submit",1),i(e.pusher_channel_token)}),c.fail(function(e){return gaDonations("send","event","advance-button","click#with-errors","submit",1),o.find(".donation-payment-errors").text(e.responseText||"Something went wrong.").show(),$(".donation-loading-overlay").hide(),o.find("button").prop("disabled",!1)}),!1)},t.submitForm=function(){var e;return gaDonations("send","event","advance-button","click#submit","submit",1),e=$("#donation-form"),$(".donation-loading-overlay").show(),e.find("button").prop("disabled",!0),Stripe.createToken(e,r),!1}},e}();